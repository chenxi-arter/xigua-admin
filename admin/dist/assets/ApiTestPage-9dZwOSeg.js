import{j as s}from"./index-D5f2_Mxj.js";import{r as p}from"./react-vendor-BZ8KDC-J.js";import{a as o}from"./client-BbHh6MVO.js";import{m as j,i as y,a as A,B as i,j as P,z as g}from"./antd-vendor-aNvYRewR.js";import"./utils-vendor-NIGUFBhG.js";const{Text:c,Paragraph:v}=y,R=()=>{const[l,n]=p.useState([]),[d,r]=p.useState(!1),t=(e,a,u,f)=>{n(x=>[...x,{test:e,success:a,data:u,error:f,timestamp:new Date().toLocaleTimeString()}])},h=async()=>{r(!0),n([]);try{console.log("测试API基础连接...");const e=await o.get("/");t("基础连接测试",!0,e.data)}catch(e){t("基础连接测试",!1,null,e.message)}try{console.log("测试平台列表API...");const e=await o.get("/api/admin/advertising/platforms");t("平台列表API",!0,e.data)}catch(e){t("平台列表API",!1,null,{message:e.message,status:e.response?.status,statusText:e.response?.statusText,url:e.config?.url})}try{console.log("测试健康检查...");const e=await o.get("/health");t("健康检查",!0,e.data)}catch(e){t("健康检查",!1,null,e.message)}try{console.log("测试API文档...");const e=await o.get("/api-docs");t("API文档",!0,e.status===200?"API文档可访问":e.data)}catch(e){t("API文档",!1,null,e.message)}r(!1)},m=async()=>{r(!0);try{console.log("使用fetch直接测试...");const e=await fetch("http://localhost:9090/api/admin/advertising/platforms"),a=await e.json();t("直接Fetch测试",e.ok,a)}catch(e){t("直接Fetch测试",!1,null,e.message)}r(!1)};return s.jsx("div",{style:{padding:24},children:s.jsxs(j,{children:[s.jsx("h2",{children:"API连接测试工具"}),s.jsxs(v,{children:["当前配置的后端地址: ",s.jsx(c,{code:!0,children:"http://localhost:9090"})]}),s.jsxs(A,{size:"middle",children:[s.jsx(i,{type:"primary",onClick:h,loading:d,children:"测试API连接"}),s.jsx(i,{onClick:m,loading:d,children:"直接Fetch测试"}),s.jsx(i,{onClick:()=>n([]),children:"清空结果"})]}),s.jsx(P,{}),s.jsx("div",{style:{maxHeight:400,overflow:"auto"},children:l.map((e,a)=>s.jsx(g,{style:{marginBottom:8},type:e.success?"success":"error",message:`${e.test} - ${e.timestamp}`,description:s.jsx("div",{children:e.success?s.jsxs("div",{children:[s.jsx(c,{type:"success",children:"✅ 成功"}),e.data&&s.jsx("pre",{style:{marginTop:8,fontSize:12,background:"#f6ffed",padding:8,borderRadius:4,maxHeight:200,overflow:"auto"},children:JSON.stringify(e.data,null,2)})]}):s.jsxs("div",{children:[s.jsx(c,{type:"danger",children:"❌ 失败"}),s.jsx("pre",{style:{marginTop:8,fontSize:12,background:"#fff2f0",padding:8,borderRadius:4,maxHeight:200,overflow:"auto"},children:JSON.stringify(e.error,null,2)})]})})},a))}),l.length===0&&s.jsx(g,{type:"info",message:"点击上方按钮开始测试API连接",description:"这个工具会帮助你诊断前后端连接问题"})]})})};export{R as default};
