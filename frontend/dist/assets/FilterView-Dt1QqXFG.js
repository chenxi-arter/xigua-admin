import{d as q,r as n,a as F,u as M,k as Y,b as p,f as s,t as B,c as g,w as u,p as I,F as b,e as w,i as x,x as L,o as r,_ as S}from"./index-BQbrX0z1.js";import{P as V}from"./index-DPVNirl3.js";import{L as j}from"./index-CaOxaCLw.js";import{R as J,a as P,C as z}from"./CoverComp-BT1MWYUg.js";import{T as Z,a as K}from"./index-CNV0hqDs.js";import"./index-BRFuJgmd.js";import{s as E}from"./request-4vVFd-gk.js";import"./index-Bg4L8zOy.js";import"./use-id-FTPuvNfh.js";import"./use-route-YVm2SLx8.js";const W={class:"channel_navigation flex h_100_vh flex_direction-column"},$={class:"nav-bar relative van-hairline--bottom"},ee={class:"center flex_auto"},ae={class:"flex_auto page_content relative"},te={class:"load-box"},se={class:"scroll-box"},le={class:"overflow-hidden"},oe={class:"load-box bottom_load_box"},ne=q({__name:"FilterView",setup(re){const C=n(1),_=n(!1),f=I(),c=M(),l=F({get:()=>({channeid:c.query.channeid,ids:c.query.ids,page:c.query.page?Number(c.query.page):C.value,size:20}),set:e=>{e.page!==void 0&&(C.value=e.page)}}),A=n([]),o=n(!1),d=n(!1),h=n(),i=n([]),y=n({list:[]}),m=async()=>{try{const e=await E.get("/api/list/getfiltersdata",{params:l.value}),a=e.data.data?.list?.length??0;d.value=a===0||a<l.value.size,i.value.push(...e.data.data?.list??[])}catch(e){console.error("失败：",e),_.value=!0,l.value.page--}},R=async()=>{d.value=!1,l.value.page=1,i.value=[],await m(),h.value=!1},Q=async()=>{d.value=!1,l.value.page=1,l.value.ids=A.value.map((e,a)=>y.value.list[a]?.list[e]?.index??0).join(","),f.replace({query:{...c.query,ids:l.value.ids}}),i.value=[],o.value=!0,await m(),o.value=!1},D=async()=>{o.value=!0,l.value.page++,await m(),o.value=!1};Y(async()=>{if(!f.options.history.state.forward||!i.value.length){d.value=!1,A.value=l.value.ids.split(",").map(e=>Number(e)),l.value.page=1,i.value=[],o.value=!0,await m(),o.value=!1;try{const e=await E.get("/api/list/getfilterstags");y.value=e.data.data}catch(e){console.error("失败：",e)}}});const N=()=>{window.history.state?.back?f.back():f.push("/")};return(e,a)=>{const O=K,U=Z,G=z,H=J,T=j,X=V;return r(),p("div",W,[s("div",$,[s("div",{class:"left",onClick:N},a[3]||(a[3]=[s("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAXNJREFUaEPt2TtKBEEYReFzMZMBd+ASXIGBmhgaGbkDlyGGJgYuQBAjAzP3YOoCRMHcRMTEkoYOOpgHXfU/ZrArmWD6cb6qoXqgxYYPbXg/EyB7BacV+LcrUEqZAXfAEXAl6aJmMlJ+Qn38E7DfR/8CM0nfYxHhgDnxXfOLpL2x8d3xoYAF8a/AoaS3tQZ4xIetgFd8CMAz3h3gHe8KiIh3AyyJP5D0XrPbLDrHfBuNjDdfgeh4U0BGvBkgK94EkBnfDMiObwKsQ3wr4BE4GezP3b9K831+1TOj+jlQSvkCtgc3OJX0sOqG1t+3AG6A80HQJ3As6dk6ctn1WgBbwC1wlomoBnTRpZR0RBNgHRDNgGyECSATYQbIQpgCMhDmgGiECyAS4QaIQrgCIhDuAG9ECMATEQbwQoQCliA+gF1J3YuOUSMcsADxA+xI6j5HjRTAAHHZvyO7lnQ/qrw/OA1QEzvvnAlgNZO115lWoHbmrM77A89a2jFh78iUAAAAAElFTkSuQmCC",alt:"",class:"left-arrow"},null,-1)])),s("div",ee,B(i.value?.[0]?.type),1),a[4]||(a[4]=s("div",{class:"right"},null,-1))]),s("div",ae,[s("div",te,[s("div",se,[g(X,{modelValue:h.value,"onUpdate:modelValue":a[2]||(a[2]=t=>h.value=t),onRefresh:R,"success-text":"刷新成功"},{default:u(()=>[s("div",le,[(r(!0),p(b,null,w(y.value.list,(t,k)=>(r(),p("div",{class:"tabs",key:t.name},[g(U,{active:A.value[k],"onUpdate:active":v=>A.value[k]=v,onChange:Q,role:""},{default:u(()=>[(r(!0),p(b,null,w(t.list,v=>(r(),x(O,{key:v.classifyId},{title:u(()=>[s("span",null,B(v.classifyName=="全部"?"最近上传":v.classifyName),1)]),_:2},1024))),128))]),_:2},1032,["active","onUpdate:active"])]))),128)),s("div",oe,[g(T,{loading:o.value,"onUpdate:loading":a[0]||(a[0]=t=>o.value=t),"immediate-check":!1,finished:d.value,error:_.value,"onUpdate:error":a[1]||(a[1]=t=>_.value=t),"error-text":"请求失败，点击重新加载","finished-text":"没有更多了",onLoad:D,class:"list",role:""},{default:u(()=>[g(H,{gutter:"10"},{default:u(()=>[(r(!0),p(b,null,w(i.value,t=>(r(),x(G,{key:t.id,span:"8"},{default:u(()=>[t.shortId?(r(),x(P,{key:0,MvItem:t,islist:!1},null,8,["MvItem"])):L("",!0)]),_:2},1024))),128))]),_:1})]),_:1},8,["loading","finished","error"])])])]),_:1},8,["modelValue"])])])])])}}}),_e=S(ne,[["__scopeId","data-v-63176a2e"]]);export{_e as default};
