import{I as p,j as e}from"./index-BLY2COp8.js";import{r as a,j as pe,R as ee}from"./react-vendor-BZ8KDC-J.js";import{b as C}from"./admin-c-2Ny3Fo.js";import{t as xe,u as je,p as j,a as w,B as c,R as te,C as g,q as m,v as ye,w as u,d as $,f as ve,x as f,s as h,y as se}from"./antd-vendor-CCOR70di.js";import{R as be}from"./EyeOutlined-DvcA2C-Q.js";import"./utils-vendor-NIGUFBhG.js";var Se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"};function T(){return T=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(r[n]=l[n])}return r},T.apply(this,arguments)}const we=(r,s)=>a.createElement(p,T({},r,{ref:s,icon:Se})),Ie=a.forwardRef(we);var ze={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"};function B(){return B=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(r[n]=l[n])}return r},B.apply(this,arguments)}const Oe=(r,s)=>a.createElement(p,B({},r,{ref:s,icon:ze})),k=a.forwardRef(Oe);function _(){return _=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(r[n]=l[n])}return r},_.apply(this,arguments)}const Ce=(r,s)=>a.createElement(p,_({},r,{ref:s,icon:xe})),ie=a.forwardRef(Ce);var ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"};function A(){return A=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(r[n]=l[n])}return r},A.apply(this,arguments)}const Ee=(r,s)=>a.createElement(p,A({},r,{ref:s,icon:ke})),ne=a.forwardRef(Ee);var Re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm144 452H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm445.7 51.5l-93.3-93.3C814.7 780.7 828 743.9 828 704c0-97.2-78.8-176-176-176s-176 78.8-176 176 78.8 176 176 176c35.8 0 69-10.7 96.8-29l94.7 94.7c1.6 1.6 3.6 2.3 5.6 2.3s4.1-.8 5.6-2.3l31-31a7.9 7.9 0 000-11.2zM652 816c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"file-search",theme:"outlined"};function P(){return P=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(r[n]=l[n])}return r},P.apply(this,arguments)}const De=(r,s)=>a.createElement(p,P({},r,{ref:s,icon:Re})),Le=a.forwardRef(De);var $e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"}}]},name:"link",theme:"outlined"};function W(){return W=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(r[n]=l[n])}return r},W.apply(this,arguments)}const Me=(r,s)=>a.createElement(p,W({},r,{ref:s,icon:$e})),Te=a.forwardRef(Me);function H(){return H=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(r[n]=l[n])}return r},H.apply(this,arguments)}const Be=(r,s)=>a.createElement(p,H({},r,{ref:s,icon:je})),_e=a.forwardRef(Be);var Ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"};function N(){return N=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(r[n]=l[n])}return r},N.apply(this,arguments)}const Pe=(r,s)=>a.createElement(p,N({},r,{ref:s,icon:Ae})),M=a.forwardRef(Pe);function qe(){const r=pe(),[s,l]=a.useState(null),[n,V]=a.useState([]),[E,re]=a.useState([]),[R,le]=a.useState([]),[y,F]=a.useState(!1),[D,v]=a.useState(null),[ae,O]=a.useState(!1),[o,oe]=a.useState(null),[ce,de]=a.useState("overview"),[d,b]=a.useState("all"),[K,L]=a.useState(null),S=async()=>{try{L(null);const t=await C.getStats();console.log("Stats API 完整响应:",t),console.log("Stats data:",t.data),console.log("重复名称数量:",t.data?.issues?.duplicateNames),l(t.data)}catch(t){console.error("加载统计失败:",t);const i=t?.response?.data?.message||t?.message||"加载统计信息失败";L(i),h.error(i)}},q=async()=>{v("missing");try{console.log("开始检查缺集问题...");const t=await C.checkMissingEpisodes();console.log("缺集检查结果:",t);const i=t?.data?.items||[];V(i),b("all"),h.success(t?.message||`检查完成，发现 ${i.length} 个问题`),await S()}catch(t){console.error("检查缺集失败:",t),V([]),h.error(t?.response?.data?.message||t?.message||"检查缺集和集重复问题失败")}finally{v(null)}},Z=async()=>{v("names");try{const t=await C.checkDuplicateNames();console.log("重复名称检查结果:",t),console.log("重复名称items:",t.data?.items),re(t.data?.items||[]),h.success(t.message||"检查完成"),await S()}catch(t){console.error("检查失败:",t),h.error(t?.response?.data?.message||"检查重复名称失败")}finally{v(null)}},G=async()=>{v("ids");try{const t=await C.checkDuplicateExternalIds();le(t.data?.items||[]),h.success(t.message||"检查完成"),await S()}catch(t){console.error("检查失败:",t),h.error(t?.response?.data?.message||"检查重复外部ID失败")}finally{v(null)}},ue=t=>{oe(t),O(!0)},fe=async()=>{F(!0);try{await S();try{await q()}catch(t){console.error("检查缺集失败:",t)}try{await Z()}catch(t){console.error("检查重复名称失败:",t)}try{await G()}catch(t){console.error("检查重复ID失败:",t)}h.success("数据已刷新")}catch(t){console.error("刷新失败:",t),h.error("刷新失败: "+(t?.message||"未知错误"))}finally{F(!1)}};a.useEffect(()=>{S()},[]),a.useEffect(()=>{const t=i=>{console.error("全局错误:",i.error),L(i.error?.message||"发生未知错误")};return window.addEventListener("error",t),()=>window.removeEventListener("error",t)},[]);const x=t=>t.status==="NO_EPISODES"?"empty":t.issues?.hasMissing&&t.issues?.hasDuplicates?"both":t.issues?.hasMissing?"missing":t.issues?.hasDuplicates?"duplicate":"empty",J=t=>{if(t.status==="NO_EPISODES")return"high";const i=(t.issues?.missingCount||0)+(t.issues?.duplicateCount||0);return i>=5?"high":i>=3?"medium":"low"},Q=t=>{if(t.message)return t.message;if(t.issues){const i=[];return t.issues.hasMissing&&i.push(`缺少${t.issues.missingCount}集`),t.issues.hasDuplicates&&i.push(`${t.issues.duplicateCount}集重复`),i.join("，")}return"-"},U=t=>{const z={missing:{color:"orange",text:"缺集"},duplicate:{color:"red",text:"重复"},both:{color:"purple",text:"混合问题"},empty:{color:"default",text:"空系列"}}[t]||{color:"default",text:t};return e.jsx(se,{color:z.color,children:z.text})},X=t=>{const z={high:{color:"red",text:"严重"},medium:{color:"orange",text:"中等"},low:{color:"gold",text:"轻微"}}[t]||{color:"default",text:t};return e.jsx(se,{color:z.color,children:z.text})},he=async t=>{console.log("切换到标签页:",t),de(t);try{t==="missing"&&n.length===0?await q():t==="names"&&E.length===0?await Z():t==="ids"&&R.length===0&&await G()}catch(i){console.error("标签页切换加载失败:",i)}},ge=ee.useMemo(()=>Array.isArray(n)?d==="all"?n:n.filter(t=>x(t)===d):(console.warn("missingIssues 不是数组:",n),[]),[n,d]),I=ee.useMemo(()=>Array.isArray(n)?{all:n.length,missing:n.filter(t=>x(t)==="missing").length,duplicate:n.filter(t=>x(t)==="duplicate").length,both:n.filter(t=>x(t)==="both").length,empty:n.filter(t=>x(t)==="empty").length}:{all:0,missing:0,duplicate:0,both:0,empty:0},[n]),me=[{title:"系列信息",key:"series",width:300,render:(t,i)=>i?e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500,marginBottom:4,color:"#1677ff",cursor:"pointer"},onClick:()=>r("/series"),title:"点击查看系列列表",children:i.seriesTitle||"未知系列"}),e.jsxs("div",{style:{fontSize:12,color:"#999"},children:["ID: ",i.seriesId," | ",i.seriesShortId]})]}):e.jsx("span",{style:{color:"#999"},children:"数据异常"})},{title:"问题类型",key:"type",width:120,render:(t,i)=>U(x(i))},{title:"严重程度",key:"severity",width:100,render:(t,i)=>X(J(i))},{title:"问题描述",key:"description",render:(t,i)=>Q(i)},{title:"集数统计",key:"episodes",width:150,render:(t,i)=>e.jsxs("div",{style:{fontSize:12},children:[e.jsxs("div",{children:["总计: ",i.totalEpisodes||0]}),i.expectedEpisodes&&e.jsxs("div",{children:["预期: ",i.expectedEpisodes]}),i.missingEpisodes&&i.missingEpisodes.length>0&&e.jsxs("div",{style:{color:"#ff4d4f"},children:["缺失: ",i.missingEpisodes.length,"集"]}),i.duplicateEpisodes&&i.duplicateEpisodes.length>0&&e.jsxs("div",{style:{color:"#faad14"},children:["重复: ",i.duplicateEpisodes.length,"集"]})]})},{title:"操作",key:"action",width:120,render:(t,i)=>e.jsx(w,{children:e.jsx(c,{size:"small",icon:e.jsx(be,{}),onClick:()=>ue(i),children:"详情"})})}],Y=[{title:"重复值",dataIndex:"title",key:"title",width:300},{title:"重复次数",dataIndex:"count",key:"count",width:100,render:t=>e.jsx(u,{count:t,showZero:!0,style:{backgroundColor:"#ff4d4f"}})},{title:"受影响系列数",key:"seriesCount",width:150,render:(t,i)=>e.jsxs("span",{children:[i.series?.length||0," 个系列"]})},{title:"操作",key:"action",width:120,render:()=>e.jsx(c,{size:"small",type:"link",children:"查看详情"})}];return e.jsxs("div",{className:"page",style:{background:"#f0f2f5",minHeight:"100vh",padding:24},children:[K&&e.jsx(j,{style:{marginBottom:24,borderColor:"#ff4d4f",background:"#fff2f0"},children:e.jsxs(w,{children:[e.jsx(k,{style:{color:"#ff4d4f",fontSize:20}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500,color:"#ff4d4f"},children:"加载失败"}),e.jsx("div",{style:{fontSize:13,color:"#666",marginTop:4},children:K}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx(c,{size:"small",onClick:()=>window.location.reload(),children:"刷新页面"}),e.jsx(c,{size:"small",style:{marginLeft:8},onClick:S,children:"重试"})]})]})]})}),e.jsxs(te,{gutter:[16,16],style:{marginBottom:24},children:[e.jsx(g,{xs:24,sm:12,lg:6,children:e.jsx(j,{loading:y,style:{borderRadius:8,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none"},bodyStyle:{padding:"20px 24px"},children:e.jsx(m,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)",fontSize:14},children:"总系列数"}),value:s?.overview.totalSeries||0,prefix:e.jsx(ne,{style:{color:"#fff"}}),valueStyle:{color:"#fff",fontSize:28,fontWeight:600}})})}),e.jsx(g,{xs:24,sm:12,lg:6,children:e.jsx(j,{loading:y,style:{borderRadius:8,background:"linear-gradient(135deg, #52c41a 0%, #73d13d 100%)",border:"none"},bodyStyle:{padding:"20px 24px"},children:e.jsx(m,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)",fontSize:14},children:"健康系列"}),value:s?.overview.healthySeries||0,prefix:e.jsx(Ie,{style:{color:"#fff"}}),valueStyle:{color:"#fff",fontSize:28,fontWeight:600}})})}),e.jsx(g,{xs:24,sm:12,lg:6,children:e.jsx(j,{loading:y,style:{borderRadius:8,background:"linear-gradient(135deg, #ff7a45 0%, #ff4d4f 100%)",border:"none"},bodyStyle:{padding:"20px 24px"},children:e.jsx(m,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)",fontSize:14},children:"问题系列"}),value:s?.overview.issuesSeries||0,prefix:e.jsx(M,{style:{color:"#fff"}}),valueStyle:{color:"#fff",fontSize:28,fontWeight:600}})})}),e.jsx(g,{xs:24,sm:12,lg:6,children:e.jsx(j,{loading:y,style:{borderRadius:8,background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",border:"none"},bodyStyle:{padding:"20px 24px"},children:e.jsx(m,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)",fontSize:14},children:"质量评分"}),value:s?.quality.score||0,suffix:e.jsx("span",{style:{fontSize:16,color:"rgba(255,255,255,0.9)",marginLeft:8,fontWeight:"bold"},children:s?.quality.grade}),valueStyle:{color:"#fff",fontSize:28,fontWeight:600}})})})]}),e.jsxs(j,{title:"问题类型分布",loading:y,style:{borderRadius:8,marginBottom:24},children:[e.jsxs(te,{gutter:[32,16],children:[e.jsx(g,{xs:12,sm:8,md:6,children:e.jsx(m,{title:"缺集问题",value:s?.issues.missingEpisodes||0,prefix:e.jsx(M,{style:{color:"#ff7a45"}}),valueStyle:{color:"#ff7a45"}})}),e.jsx(g,{xs:12,sm:8,md:6,children:e.jsx(m,{title:"重复集数",value:s?.issues.duplicateEpisodes||0,prefix:e.jsx(ie,{style:{color:"#faad14"}}),valueStyle:{color:"#faad14"}})}),e.jsx(g,{xs:12,sm:8,md:6,children:e.jsx(m,{title:"空系列",value:s?.issues.emptySeries||0,prefix:e.jsx(k,{style:{color:"#8c8c8c"}}),valueStyle:{color:"#8c8c8c"}})}),e.jsx(g,{xs:12,sm:8,md:6,children:e.jsx(m,{title:"重复名称",value:s?.issues.duplicateNames||0,prefix:e.jsx(Le,{style:{color:"#1677ff"}}),valueStyle:{color:"#1677ff"}})})]}),s?.lastCheck&&e.jsxs("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #f0f0f0",color:"#999"},children:["最后检查: ",new Date(s.lastCheck.timestamp).toLocaleString(),"(耗时: ",s.lastCheck.duration,"ms)"]})]}),e.jsx(j,{style:{borderRadius:8},children:e.jsx(ye,{activeKey:ce,onChange:he,tabBarExtraContent:e.jsx(w,{children:e.jsx(c,{type:"primary",icon:e.jsx(_e,{}),onClick:fe,loading:y,children:"全量刷新"})}),items:[{key:"overview",label:"概览",children:e.jsxs("div",{style:{textAlign:"center",padding:"60px 20px"},children:[e.jsx(ne,{style:{fontSize:64,color:"#1677ff",marginBottom:24}}),e.jsx("h2",{style:{fontSize:20,marginBottom:16,color:"#333"},children:"数据验证中心"}),e.jsx("p",{style:{fontSize:14,color:"#666",marginBottom:32,maxWidth:600,margin:"0 auto 32px"},children:'点击上方的标签页自动检查对应的数据质量问题，或使用"全量刷新"按钮一次性检查所有问题'}),e.jsxs(w,{direction:"vertical",size:"middle",style:{width:"100%",maxWidth:500,margin:"0 auto"},children:[e.jsxs("div",{style:{textAlign:"left",padding:"16px",background:"#f0f2f5",borderRadius:8},children:[e.jsx("div",{style:{marginBottom:8,fontWeight:500},children:"📊 数据概览"}),e.jsxs("div",{style:{fontSize:13,color:"#666"},children:["总系列: ",s?.overview.totalSeries||0," | 健康: ",s?.overview.healthySeries||0," | 问题: ",s?.overview.issuesSeries||0]})]}),e.jsxs("div",{style:{textAlign:"left",padding:"16px",background:"#fff7e6",borderRadius:8},children:[e.jsx("div",{style:{marginBottom:8,fontWeight:500},children:"⚠️ 快速操作"}),e.jsxs("div",{style:{fontSize:13,color:"#666"},children:['点击"缺集和集重复"标签查看剧集问题',e.jsx("br",{}),'点击"重复名称"标签查看重名系列',e.jsx("br",{}),'点击"重复外部ID"标签查看ID冲突']})]})]})]})},{key:"missing",label:e.jsx(u,{count:n.length,offset:[10,0],children:e.jsx("span",{children:"缺集和集重复"})}),children:e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16,padding:"12px 16px",background:"#fafafa",borderRadius:8},children:[e.jsx("div",{style:{marginBottom:8,color:"#666",fontSize:14},children:"筛选问题类型："}),e.jsxs(w,{wrap:!0,children:[e.jsxs(c,{type:d==="all"?"primary":"default",onClick:()=>b("all"),size:"middle",children:["全部 ",e.jsx(u,{count:I.all,style:{marginLeft:8,backgroundColor:"#52c41a"}})]}),e.jsxs(c,{type:d==="missing"?"primary":"default",onClick:()=>b("missing"),icon:e.jsx(M,{}),size:"middle",children:["缺集 ",e.jsx(u,{count:I.missing,style:{marginLeft:8,backgroundColor:"#ff7a45"}})]}),e.jsxs(c,{type:d==="duplicate"?"primary":"default",onClick:()=>b("duplicate"),icon:e.jsx(ie,{}),size:"middle",children:["重复 ",e.jsx(u,{count:I.duplicate,style:{marginLeft:8,backgroundColor:"#f5222d"}})]}),e.jsxs(c,{type:d==="both"?"primary":"default",onClick:()=>b("both"),danger:d==="both",size:"middle",children:["混合问题 ",e.jsx(u,{count:I.both,style:{marginLeft:8,backgroundColor:"#722ed1"}})]}),e.jsxs(c,{type:d==="empty"?"primary":"default",onClick:()=>b("empty"),icon:e.jsx(k,{}),size:"middle",children:["空系列 ",e.jsx(u,{count:I.empty,style:{marginLeft:8,backgroundColor:"#8c8c8c"}})]})]})]}),e.jsx($,{rowKey:t=>t?.seriesId||Math.random().toString(),dataSource:ge,columns:me,pagination:{pageSize:10,showTotal:t=>`共 ${t} 条`},loading:D==="missing",locale:{emptyText:"暂无问题"}})]})},{key:"names",label:e.jsx(u,{count:E.length,offset:[10,0],children:e.jsx("span",{children:"重复名称"})}),children:e.jsx($,{rowKey:t=>t?.title||Math.random().toString(),dataSource:E,columns:Y,pagination:{pageSize:10,showTotal:t=>`共 ${t} 条`},loading:D==="names",locale:{emptyText:"暂无重复名称"},expandable:{expandedRowRender:t=>e.jsxs("div",{style:{padding:"12px 24px",background:"#fafafa"},children:[e.jsx("h4",{children:"受影响的系列:"}),t.series.map(i=>e.jsxs("div",{style:{marginBottom:8,padding:8,background:"#fff",borderRadius:4},children:[e.jsx("div",{children:e.jsx("strong",{style:{color:"#1677ff",cursor:"pointer"},onClick:()=>r("/series"),title:"点击查看系列列表",children:i.title})}),e.jsxs("div",{style:{fontSize:12,color:"#999"},children:["ID: ",i.id," | ",i.shortId," | 外部ID: ",i.externalId||"无"," | 创建时间: ",new Date(i.createdAt).toLocaleString()]})]},i.id))]})}})},{key:"ids",label:e.jsx(u,{count:R.length,offset:[10,0],children:e.jsx("span",{children:"重复外部ID"})}),children:e.jsx($,{rowKey:t=>t?.title||Math.random().toString(),dataSource:R,columns:Y,pagination:{pageSize:10,showTotal:t=>`共 ${t} 条`},loading:D==="ids",locale:{emptyText:"暂无重复外部ID"},expandable:{expandedRowRender:t=>e.jsxs("div",{style:{padding:"12px 24px",background:"#fafafa"},children:[e.jsx("h4",{children:"受影响的系列:"}),t.series.map(i=>e.jsxs("div",{style:{marginBottom:8,padding:8,background:"#fff",borderRadius:4},children:[e.jsx("div",{children:e.jsx("strong",{style:{color:"#1677ff",cursor:"pointer"},onClick:()=>r("/series"),title:"点击查看系列列表",children:i.title})}),e.jsxs("div",{style:{fontSize:12,color:"#999"},children:["ID: ",i.id," | ",i.shortId," | 外部ID: ",i.externalId||"无"," | 创建时间: ",new Date(i.createdAt).toLocaleString()]})]},i.id))]})}})}]})}),e.jsx(ve,{title:"系列详情",open:ae,onCancel:()=>O(!1),footer:e.jsxs(w,{children:[e.jsx(c,{onClick:()=>O(!1),children:"关闭"}),e.jsx(c,{type:"primary",icon:e.jsx(Te,{}),onClick:()=>{r("/series"),O(!1)},children:"前往系列页面"})]}),width:800,children:o&&e.jsxs("div",{children:[e.jsxs(f,{column:2,bordered:!0,children:[e.jsx(f.Item,{label:"系列ID",children:o.seriesId}),e.jsx(f.Item,{label:"Short ID",children:o.seriesShortId}),e.jsx(f.Item,{label:"标题",span:2,children:o.seriesTitle}),e.jsx(f.Item,{label:"问题类型",children:U(x(o))}),e.jsx(f.Item,{label:"严重程度",children:X(J(o))}),e.jsx(f.Item,{label:"问题描述",span:2,children:Q(o)}),e.jsx(f.Item,{label:"总集数",children:o.totalEpisodes}),e.jsx(f.Item,{label:"预期集数",children:o.expectedEpisodes||"-"})]}),o.missingEpisodes&&o.missingEpisodes.length>0&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx("h4",{children:"缺失的集数:"}),e.jsx("div",{style:{background:"#fff2e8",padding:12,borderRadius:4},children:o.missingEpisodes.join(", ")})]}),o.duplicateEpisodes&&o.duplicateEpisodes.length>0&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx("h4",{children:"重复的集数:"}),e.jsx("div",{style:{background:"#fffbe6",padding:12,borderRadius:4},children:o.duplicateEpisodes.join(", ")})]}),o.status==="NO_EPISODES"&&e.jsxs("div",{style:{marginTop:16,padding:16,background:"#f5f5f5",borderRadius:8,textAlign:"center"},children:[e.jsx(k,{style:{fontSize:32,color:"#8c8c8c",marginBottom:8}}),e.jsx("div",{style:{color:"#666"},children:"该系列没有任何剧集"})]})]})})]})}export{qe as default};
