import{d as M,r as i,Q,A as U,p as y,q as h,T as L,y as e,z as _,a as m,s as f,F as V,v as D,U as B,_ as G,N as Z,O as j,ar as z,C as I,aD as J,Z as K,G as T,D as F,S as q,R as W}from"./index-DrvgCaYm.js";import{a as $,T as ee}from"./index-D3WUFRhV.js";import{a as se,S as ae}from"./index-ebv34nvs.js";import{P as te}from"./index-DZRAJ-oJ.js";import{L as oe}from"./index-Bs7__jMy.js";import"./use-id-mvc9Pq9L.js";import"./use-route-ZYt1T88L.js";const le="/static/img/no_data.png",ne={class:"load-box"},ie={key:0,class:"empty"},re={class:"main-text"},ce={class:"scroll-box"},ue={class:"video"},de={class:"video-info"},ve={class:"left"},pe={class:"preview"},Ae={class:"my-image"},he={class:"van-image"},fe=["src"],_e={class:"video-info"},me={class:"info-b"},ge={class:"update flex_auto"},we={class:"right flex_direction-column"},ye={class:"right-t"},be={class:"van-ellipsis"},xe={class:"date"},Re={class:"star van-ellipsis"},Ce={class:"introduce_info"},Se={class:"right-b flex align_item-center justify_content-sb"},ke=M({__name:"SearchComp",props:{inputValue:{},cid:{}},setup(N,{expose:b}){const v=i(!1),t=i(!1),p=i(!1),g=i(!1),A=i(""),r=N,c=i([]),x=async(w=20,o=!1)=>{if(o&&(t.value=!0,p.value=!1,c.value=[]),r.inputValue)try{const u=await B.get("/api/list/fuzzysearch",{params:{keyword:r.inputValue,page:Math.floor(c.value.length/20)+1,size:w,categoryId:r.cid}}),R=u.data.data.list.filter(S=>S.title===r.inputValue),C=u.data.data.list.filter(S=>S.title!==r.inputValue),a=[...R,...C];c.value.push(...a),a.length<w&&(p.value=!0)}catch(u){console.error("SearchView.vue searchBtn error",u),g.value=!0}else p.value=!0;t.value=!1};b({searchPro:x});const k=async()=>{p.value=!1,t.value=!1,c.value=[],await x(),v.value=!1},E=async()=>{v.value=!1,t.value=!0,await x(),t.value=!1};return Q(async()=>{/iphone|ipod|android|blackberry|windows phone/i.test(navigator.userAgent.toLowerCase())?A.value="seriesPlay":A.value="play"}),(w,o)=>{const u=U("RouterLink"),R=oe,C=te;return h(),y("div",ne,[c.value?.length==0&&t.value==!1?(h(),y("div",ie,[o[3]||(o[3]=e("img",{src:le,alt:""},null,-1)),e("h4",re,'未找到包含"'+_(w.inputValue)+'"的视频',1)])):L("",!0),e("div",ce,[m(C,{modelValue:v.value,"onUpdate:modelValue":o[2]||(o[2]=a=>v.value=a),onRefresh:k,"success-text":"刷新成功"},{default:f(()=>[m(R,{loading:t.value,"onUpdate:loading":o[0]||(o[0]=a=>t.value=a),finished:p.value,"finished-text":"没有更多了",onLoad:E,error:g.value,"onUpdate:error":o[1]||(o[1]=a=>g.value=a),role:"","error-text":"请求失败，点击重新加载"},{default:f(()=>[e("div",ue,[(h(!0),y(V,null,D(c.value,a=>(h(),y("div",{class:"series",key:a.id},[e("div",de,[e("div",ve,[e("div",pe,[e("div",Ae,[e("div",he,[m(u,{to:{name:A.value,params:{id:a.shortId}}},{default:f(()=>[e("img",{class:"van-image__img",src:a.coverUrl,lazy:"loaded",style:{"object-fit":"fill"}},null,8,fe)]),_:2},1032,["to"])])]),e("div",_e,[o[4]||(o[4]=e("div",{class:"score"},null,-1)),e("div",me,[e("div",ge,_(a.upStatus),1)])])])]),e("div",we,[m(u,{to:{name:A.value,params:{id:a.shortId}}},{default:f(()=>[e("div",ye,[e("h3",be,_(a.title),1),e("div",xe,[e("span",null,_(a.createdAt.split("-")[0]),1),e("i",null,_(a.type),1)]),e("p",Re," 主演："+_(a.author),1),e("div",Ce,_(a.description.slice(0,50))+" ... ",1)])]),_:2},1032,["to"]),e("div",Se,[m(u,{to:{name:A.value,params:{id:a.shortId}}},{default:f(()=>o[5]||(o[5]=[e("button",{class:"flex_none"}," 立即播放 ",-1)])),_:2,__:[5]},1032,["to"])])])])]))),128))])]),_:1},8,["loading","finished","error"])]),_:1},8,["modelValue"])])])}}}),Be=G(ke,[["__scopeId","data-v-ab9e09b1"]]),Ee={class:"serach-page flex_direction-column h_100_vh"},Oe={class:"top van-hairline--bottom"},Ie={class:"nav-bar relative"},Ve={class:"center flex_auto"},De={class:"search-bar"},Ne={class:"input-box notranslate"},Te={class:"handler absolute flex align_item-center"},Fe={class:"placeholder-carousel"},Me={style:{flex:"1","min-height":"0"}},Qe={class:"main"},Ge=M({__name:"SearchView",setup(N){const b=Z(),v=j(),t=i(""),p=i(0),g=i([]),A=i(!0),r=i([]),c=i(""),x=()=>{t.value=""},k=i([{name:"全部",id:null}]),E=async()=>{try{const s=(await B.get("/api/home/categories")).data.sort((n,O)=>n.id-O.id).map(n=>({...n,isMounted:!1}));k.value.push(...s)}catch(l){console.error(l)}},w=async(l=6,s=null)=>{try{const n=await B.get("/api/search/hot-keywords",{params:{limit:l,categoryId:s}});r.value=n.data.data||n.data,c.value=r.value[0]}catch(n){console.error(n)}},o=async(l=10,s=null)=>{try{const n=await B.get("/api/search/hot-keywords",{params:{limit:l,categoryId:s}});r.value=n.data.data||n.data,c.value=r.value[0]}catch(n){console.error(n)}},u=async()=>{b.replace({name:"search",params:{id:t.value}}),t.value||(t.value=c.value),await W();const l=p.value||0,s=g.value[l];s?s.searchPro(20,!0):console.warn("子组件未就绪或未找到")},R=()=>{window.history.state?.back?b.back():b.push("/")};Q(async()=>{if(w(),E(),v.params.id){const l=Array.isArray(v.params.id)?v.params.id[0]:v.params.id;t.value=l}});const C=l=>{c.value=r.value[l||0]},a=(l,s)=>{l?g.value[s]=l:delete g.value[s]},S=async()=>{o()};return(l,s)=>{const n=se,O=ae,H=$,X=ee;return h(),y("div",Ee,[e("div",Oe,[e("div",Ie,[e("div",{class:"left",onClick:R},s[4]||(s[4]=[e("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAXNJREFUaEPt2TtKBEEYReFzMZMBd+ASXIGBmhgaGbkDlyGGJgYuQBAjAzP3YOoCRMHcRMTEkoYOOpgHXfU/ZrArmWD6cb6qoXqgxYYPbXg/EyB7BacV+LcrUEqZAXfAEXAl6aJmMlJ+Qn38E7DfR/8CM0nfYxHhgDnxXfOLpL2x8d3xoYAF8a/AoaS3tQZ4xIetgFd8CMAz3h3gHe8KiIh3AyyJP5D0XrPbLDrHfBuNjDdfgeh4U0BGvBkgK94EkBnfDMiObwKsQ3wr4BE4GezP3b9K831+1TOj+jlQSvkCtgc3OJX0sOqG1t+3AG6A80HQJ3As6dk6ctn1WgBbwC1wlomoBnTRpZR0RBNgHRDNgGyECSATYQbIQpgCMhDmgGiECyAS4QaIQrgCIhDuAG9ECMATEQbwQoQCliA+gF1J3YuOUSMcsADxA+xI6j5HjRTAAHHZvyO7lnQ/qrw/OA1QEzvvnAlgNZO115lWoHbmrM77A89a2jFh78iUAAAAAElFTkSuQmCC",alt:"",class:"left-arrow"},null,-1)])),e("div",Ve,[e("form",{onSubmit:z(u,["prevent"])},[e("div",De,[e("div",Ne,[I(e("input",{onKeydown:K(u,["enter"]),onFocus:s[0]||(s[0]=d=>A.value=!1),onBlur:s[1]||(s[1]=d=>A.value=!0),onInput:S,type:"text",maxlength:"100",autofocus:"true","onUpdate:modelValue":s[2]||(s[2]=d=>t.value=d)},null,544),[[J,t.value]]),e("div",Te,[I(e("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAwRJREFUaEPtmEuojVEUx39/hDwzEKUMFHlk4jERpcw8Jh5JlBEjE5IRI0YSEyNGiqSLicdMKTLxmOgitwyUIgN53ZBrOeu2z23fr+985/vOd+697Tp7dOqsvb/1W+u/1n6IxIcS958ewERnsJeBXgZqRqAnoWYAzWwqsBRYAiwE5gHTwv+/gS/AR+AdMCDpT83gD0+vnQEzc0c3AqsBhygz3PmXwGNJDtbx6BjAzCYDm4ENgP/uZAwBTxrrPJTkvyuPjgDMbCawF1hc+Yv5E94DNyT9rLpeZQAzmw8cAObmfOw78AZ4C3wCBoPNDGABsAxYDszOmfsVuCrpcxWISgAh8odznP/hMgBeSPpX5ICZTQLWBPnNytg6xKUqmSgNEDR/MEc2A40CviXpV5XImdn0RiHvCp0rnupyulK2JqoAbAE2ZZx8BtxvF/VWYCEbW4F1GZtHkh6UCUgpgNAqj2S6jUf+eqfON50LEPsymfCOdLFMiy0LsANYG0XENe8fGJFNkNhOoF/Sq7zomdlKYBVwO5ZIkJMHKK6J55LutMtCW4Cwwx7PbFJ3Jbl8hkdwfnejFa4AvIhvZiGC827jRfw62Iz0fjNzGW2PHPbN7ly7HbsMgEdsT7Swt8oLsXTMzP93u+YYBZFxvmnjmerLSOlopsX2SeovykIZgKx8nkq6Fy/awsFhiGDXjHwuYASxDVgfrd1WRmUADgGLokWvSfICHjUKINzOZVPofJCiHwb3R7YfJF2um4ETgO+kzXFe0re8RVtAxKa59RFlYA5wLJowKOlsXYBTmfZ5RtLfVosWQBQ6HzIwBTgZrT0k6fR4A3gn8qKOZeM+OIAXpXeg3GFmYwKQvISSL+I6bbTZ57OSarXZjUkb7XQjG9H7RG9kfs9N9ygR2lu6h7kA4C8P6R6nA0S6F5oA4E8n6V4pA4Q/p6R5qY8OXOk+q0QQ6T5sRRDpPi3GR8lkH3ez5+Fkn9eLLhvj8V/bO/F4OFHnGz2AOtHrxtxeBroRxTpr9DJQJ3rdmPsf4S66QDoGjn0AAAAASUVORK5CYII=",alt:"",class:"close",onClick:x},null,512),[[T,t.value.length]])])]),I(e("div",Fe,[m(O,{"show-indicators":!1,autoplay:A.value?6e3:0,style:{height:"0.8666667rem"},vertical:"",onChange:C},{default:f(()=>[(h(!0),y(V,null,D(r.value,d=>(h(),F(n,{key:d,class:"placeholder"},{default:f(()=>[q(_(d),1)]),_:2},1024))),128))]),_:1},8,["autoplay"])],512),[[T,!t.value]]),e("div",{class:"button",onClick:u},"搜索")])],32)]),s[5]||(s[5]=e("div",{class:"right"},null,-1))])]),e("div",Me,[m(X,{active:p.value,"onUpdate:active":s[3]||(s[3]=d=>p.value=d),style:{height:"100%"}},{default:f(()=>[(h(!0),y(V,null,D(k.value,(d,Y)=>(h(),F(H,{key:d.name,title:d.name},{default:f(()=>[e("div",Qe,[m(Be,{ref_for:!0,ref:P=>a(P,Y),inputValue:t.value,cid:d.id,placeholder:c.value},null,8,["inputValue","cid","placeholder"])])]),_:2},1032,["title"]))),128))]),_:1},8,["active"])])])}}}),je=G(Ge,[["__scopeId","data-v-0da3c7aa"]]);export{je as default};
