import{I as K,j as e,R as T,a as z,b as y,c as C}from"./index-BLY2COp8.js";import{r as i,j as G}from"./react-vendor-BZ8KDC-J.js";import{D as u,B as $}from"./admin-c-2Ny3Fo.js";import{R as d,C as r,p as n,q as c,d as H,n as b,r as h}from"./antd-vendor-CCOR70di.js";import{R as B}from"./EyeOutlined-DvcA2C-Q.js";import"./utils-vendor-NIGUFBhG.js";var J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917 211.1l-199.2 24c-6.6.8-9.4 8.9-4.7 13.6l59.3 59.3-226 226-101.8-101.7c-6.3-6.3-16.4-6.2-22.6 0L100.3 754.1a8.03 8.03 0 000 11.3l45 45.2c3.1 3.1 8.2 3.1 11.3 0L433.3 534 535 635.7c6.3 6.2 16.4 6.2 22.6 0L829 364.5l59.3 59.3a8.01 8.01 0 0013.6-4.7l24-199.2c.7-5.1-3.7-9.5-8.9-8.8z"}}]},name:"rise",theme:"outlined"};function S(){return S=Object.assign?Object.assign.bind():function(l){for(var t=1;t<arguments.length;t++){var g=arguments[t];for(var x in g)Object.prototype.hasOwnProperty.call(g,x)&&(l[x]=g[x])}return l},S.apply(this,arguments)}const Q=(l,t)=>i.createElement(K,S({},l,{ref:t,icon:J})),V=i.forwardRef(Q);function re(){const l=G(),[t,g]=i.useState(null),[x,L]=i.useState([]),[f,A]=i.useState({users:[],series:[],episodes:[],comments:[]}),[a,v]=i.useState(!1),[O,D]=i.useState([]),[M,R]=i.useState([]),[I,W]=i.useState(!1),[m,P]=i.useState(!1),_=async()=>{v(!0);try{const s=new Date(Date.now()-12096e5).toISOString().slice(0,10),j=new Date().toISOString().slice(0,10),[o,E,U,F,N]=await Promise.all([u.overview(),u.top({metric:"series_play",limit:10}),u.recentActivities({limit:10}),u.timeseries({from:s,to:j,granularity:"day"}),$.list(1,1)]);g(o),L(E.items||[]),A(U),D(F.series||[]);const w=N?.items?.[0];if(w?.id!=null){const k=await $.stats(w.id,{from:s,to:j}),q=Array.isArray(k)?k:[];R(q.map(p=>({date:p.date,impressions:p.impressions||0,clicks:p.clicks||0,ctr:p.impressions?Math.round((p.clicks||0)/p.impressions*1e3)/10:0})))}else R([])}finally{v(!1)}};return i.useEffect(()=>{_()},[]),e.jsxs("div",{className:"page",children:[e.jsxs(d,{gutter:[16,16],children:[e.jsx(r,{xs:24,sm:12,lg:6,children:e.jsx(n,{loading:a,hoverable:!0,onClick:()=>l("/users"),style:{borderRadius:8,cursor:"pointer",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none"},bodyStyle:{padding:"20px 24px"},children:e.jsx(c,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)",fontSize:14},children:"用户总数"}),value:t?.users.total||0,suffix:e.jsxs("span",{style:{fontSize:14,color:"rgba(255,255,255,0.75)"},children:["(+",t?.users.new24h||0,"/24h)"]}),prefix:e.jsx(T,{style:{color:"#fff"}}),valueStyle:{color:"#fff",fontSize:28,fontWeight:600}})})}),e.jsx(r,{xs:24,sm:12,lg:6,children:e.jsx(n,{loading:a,hoverable:!0,onClick:()=>l("/banners"),style:{borderRadius:8,cursor:"pointer",background:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",border:"none"},bodyStyle:{padding:"20px 24px"},children:e.jsx(c,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)",fontSize:14},children:"轮播图"}),value:t?.banners.total||0,prefix:e.jsx(z,{style:{color:"#fff"}}),valueStyle:{color:"#fff",fontSize:28,fontWeight:600}})})}),e.jsx(r,{xs:24,sm:12,lg:6,children:e.jsx(n,{loading:a,hoverable:!0,onClick:()=>l("/series"),style:{borderRadius:8,cursor:"pointer",background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",border:"none"},bodyStyle:{padding:"20px 24px"},children:e.jsx(c,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)",fontSize:14},children:"系列总数"}),value:t?.series.total||0,prefix:e.jsx(y,{style:{color:"#fff"}}),valueStyle:{color:"#fff",fontSize:28,fontWeight:600}})})}),e.jsx(r,{xs:24,sm:12,lg:6,children:e.jsx(n,{loading:a,hoverable:!0,onClick:()=>l("/episodes"),style:{borderRadius:8,cursor:"pointer",background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",border:"none"},bodyStyle:{padding:"20px 24px"},children:e.jsx(c,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)",fontSize:14},children:"剧集总数"}),value:t?.episodes.total||0,prefix:e.jsx(C,{style:{color:"#fff"}}),valueStyle:{color:"#fff",fontSize:28,fontWeight:600}})})})]}),e.jsx(d,{gutter:[16,16],style:{marginTop:16},children:e.jsx(r,{span:24,children:e.jsxs(n,{title:"轮播统计（24h/累计）",loading:a,style:{borderRadius:8},children:[e.jsxs(d,{gutter:[32,16],children:[e.jsx(r,{xs:24,sm:12,md:8,children:e.jsx(c,{title:"总曝光",value:t?.banners.totalImpressions??0,prefix:e.jsx(B,{}),valueStyle:{color:"#1677ff"}})}),e.jsx(r,{xs:24,sm:12,md:8,children:e.jsx(c,{title:"总点击",value:t?.banners.totalClicks??0,prefix:e.jsx(z,{}),valueStyle:{color:"#52c41a"}})}),e.jsx(r,{xs:24,sm:12,md:8,children:e.jsx(c,{title:"平均点击率",value:t?.banners.totalImpressions?((t?.banners.totalClicks||0)/t.banners.totalImpressions*100).toFixed(2):0,suffix:"%",valueStyle:{color:"#fa8c16"}})})]}),e.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #f0f0f0"},children:e.jsx("a",{onClick:()=>l("/banners"),style:{fontSize:14},children:"去管理轮播图 →"})})]})})}),e.jsxs(d,{gutter:[16,16],style:{marginTop:16},children:[e.jsx(r,{xs:24,lg:12,children:e.jsx(n,{title:e.jsxs("span",{children:[e.jsx(V,{style:{marginRight:8,color:"#1677ff"}}),"用户增长（近两周）"]}),loading:a,style:{borderRadius:8,height:"100%"},children:e.jsx("div",{style:{height:220,display:"flex",alignItems:"flex-end",gap:6,padding:"12px 0",background:"#fafafa",borderRadius:6,paddingLeft:12,paddingRight:12},children:O.map(s=>e.jsx("div",{title:`${s.date}
新增: ${s.newUsers} 人`,style:{flex:1,height:`${Math.max(8,Math.min(190,s.newUsers*1.5))}px`,background:"linear-gradient(180deg, #667eea 0%, #764ba2 100%)",borderRadius:"4px 4px 0 0",transition:"all 0.3s",cursor:"pointer",boxShadow:"0 2px 4px rgba(102, 126, 234, 0.2)"}},s.date))})})}),e.jsx(r,{xs:24,lg:12,children:e.jsx(n,{title:e.jsxs("span",{children:[e.jsx(B,{style:{marginRight:8,color:"#52c41a"}}),"轮播点击率CTR（近两周）"]}),loading:a,style:{borderRadius:8,height:"100%"},children:e.jsx("div",{style:{height:220,display:"flex",alignItems:"flex-end",gap:6,padding:"12px 0",background:"#fafafa",borderRadius:6,paddingLeft:12,paddingRight:12},children:M.map(s=>e.jsx("div",{title:`${s.date}
CTR: ${s.ctr}%
曝光: ${s.impressions}
点击: ${s.clicks}`,style:{flex:1,height:`${Math.max(8,Math.min(190,Math.round(s.ctr*15)))}px`,background:"linear-gradient(180deg, #52c41a 0%, #73d13d 100%)",borderRadius:"4px 4px 0 0",transition:"all 0.3s",cursor:"pointer",boxShadow:"0 2px 4px rgba(82, 196, 26, 0.2)"}},s.date))})})})]}),e.jsx(d,{gutter:[16,16],style:{marginTop:16},children:e.jsx(r,{span:24,children:e.jsx(n,{title:e.jsxs("span",{children:[e.jsx(y,{style:{marginRight:8,color:"#1677ff"}}),"Top 系列（播放量）"]}),loading:a,extra:e.jsx("a",{onClick:()=>W(s=>!s),children:I?"收起":"展开更多"}),style:{borderRadius:8},children:e.jsx(H,{rowKey:s=>`${s.seriesId}`,size:"middle",dataSource:I?x:(x||[]).slice(0,5),pagination:!1,columns:[{title:"排名",width:80,render:(s,j,o)=>e.jsxs("span",{style:{fontWeight:o<3?"bold":"normal",color:o===0?"#f5222d":o===1?"#fa8c16":o===2?"#faad14":"#666"},children:["#",o+1]})},{title:"系列ID",dataIndex:"seriesId",width:100},{title:"标题",dataIndex:"title"},{title:"播放量",dataIndex:"playCount",width:150,render:s=>e.jsx("span",{style:{color:"#1677ff",fontWeight:500},children:s?.toLocaleString()||0})}]})})})}),e.jsx(d,{gutter:[16,16],style:{marginTop:16,marginBottom:16},children:e.jsx(r,{span:24,children:e.jsx(n,{title:"最新动态",loading:a,extra:e.jsx("a",{onClick:()=>P(s=>!s),children:m?"收起":"展开更多"}),style:{borderRadius:8},children:e.jsxs(d,{gutter:[16,16],children:[e.jsxs(r,{xs:24,md:8,children:[e.jsxs(b.Title,{level:5,style:{marginBottom:12},children:[e.jsx(T,{style:{marginRight:8,color:"#667eea"}}),"新增用户"]}),e.jsx(h,{size:"small",dataSource:m?f.users:(f.users||[]).slice(0,5),renderItem:s=>e.jsxs(h.Item,{style:{borderBottom:"1px solid #f0f0f0",padding:"8px 0"},children:[e.jsxs("span",{style:{color:"#666"},children:["#",s.id]}),e.jsx("span",{style:{marginLeft:8},children:s.username})]})})]}),e.jsxs(r,{xs:24,md:8,children:[e.jsxs(b.Title,{level:5,style:{marginBottom:12},children:[e.jsx(y,{style:{marginRight:8,color:"#4facfe"}}),"新增系列"]}),e.jsx(h,{size:"small",dataSource:m?f.series:(f.series||[]).slice(0,5),renderItem:s=>e.jsxs(h.Item,{style:{borderBottom:"1px solid #f0f0f0",padding:"8px 0"},children:[e.jsxs("span",{style:{color:"#666"},children:["#",s.id]}),e.jsx("span",{style:{marginLeft:8},children:s.title})]})})]}),e.jsxs(r,{xs:24,md:8,children:[e.jsxs(b.Title,{level:5,style:{marginBottom:12},children:[e.jsx(C,{style:{marginRight:8,color:"#f5576c"}}),"新增剧集"]}),e.jsx(h,{size:"small",dataSource:m?f.episodes:(f.episodes||[]).slice(0,5),renderItem:s=>e.jsxs(h.Item,{style:{borderBottom:"1px solid #f0f0f0",padding:"8px 0"},children:[e.jsxs("span",{style:{color:"#666"},children:["#",s.id]}),e.jsx("span",{style:{marginLeft:8},children:s.title})]})})]})]})})})})]})}export{re as default};
