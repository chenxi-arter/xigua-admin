import{d as H,r,n as X,b as u,c as i,f as s,w as a,F as B,e as y,j as k,x as N,i as O,t as g,o as n,A as R,_ as Y}from"./index-VJJ6XrVB.js";import{S as F,a as G}from"./index-DiEwUxtr.js";import{P}from"./index-BOFbMo8I.js";import{L as K}from"./index-CUxhZJU3.js";import{C as T}from"./index-C-i0UiBn.js";import{T as V,a as j}from"./index-eRE_PPL9.js";import{N as z}from"./index-TVfmCGAp.js";import{s as W}from"./request-DYQEwhhF.js";import"./index-BEP1TWU2.js";import"./use-route-CbfQQ3_s.js";import"./use-id-CYO2FsV8.js";import"./use-placeholder-CpzLrxrk.js";const q={class:"flex h_100_vh flex_direction-column"},Z={class:"tabs flex_none"},$={class:"flex_auto overflow-hidden page_content"},ee={class:"load-box"},te={class:"scroll-box"},se={class:"left flex_none"},ae={class:"my-image"},oe={class:"van-image"},ne=["src"],le={class:"right flex_auto overflow-hidden"},re={key:0},ie={key:1},Ae=H({__name:"HistoryView",setup(de){const C=r(0),A=r(!1),v=r(!1),f=r(!1),p=r(!1);let m=1;const _=r([]),w=async(l=1,e=20)=>{try{const o=await W.get("/api/video/browse-history",{params:{page:l,size:e}}),d=o.data.data.list.length??0;v.value=d===0||d<e,_.value.push(...o.data.data.list??[])}catch(o){console.error(o),f.value=!0,m--}},U=l=>{const e=Math.floor(l/3600),o=Math.floor(l%3600/60),d=l%60,S=e>0?String(e).padStart(2,"0")+":":"",b=String(o).padStart(2,"0"),h=String(d).padStart(2,"0");return S+b+":"+h},E=r("");X(async()=>{/iphone|ipod|android|blackberry|windows phone/i.test(navigator.userAgent.toLowerCase())?E.value="seriesPlay":E.value="play",A.value=!0,await w(),A.value=!1});const Q=async()=>{v.value=!1,m=1,_.value=[],p.value=!0,await w(),p.value=!1},x=async()=>{m++,A.value=!0,await w(m),A.value=!1},M=()=>{window.history.state?.back?R.back():R.push("/")};return(l,e)=>{const o=z,d=j,S=V,b=O("RouterLink"),h=T,D=K,I=P,J=G,L=F;return n(),u("div",q,[i(o,{title:"历史记录","left-arrow":"",class:"relative nav-bar",style:{color:"aliceblue"},onClickLeft:M},{left:a(()=>e[4]||(e[4]=[s("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAXNJREFUaEPt2TtKBEEYReFzMZMBd+ASXIGBmhgaGbkDlyGGJgYuQBAjAzP3YOoCRMHcRMTEkoYOOpgHXfU/ZrArmWD6cb6qoXqgxYYPbXg/EyB7BacV+LcrUEqZAXfAEXAl6aJmMlJ+Qn38E7DfR/8CM0nfYxHhgDnxXfOLpL2x8d3xoYAF8a/AoaS3tQZ4xIetgFd8CMAz3h3gHe8KiIh3AyyJP5D0XrPbLDrHfBuNjDdfgeh4U0BGvBkgK94EkBnfDMiObwKsQ3wr4BE4GezP3b9K831+1TOj+jlQSvkCtgc3OJX0sOqG1t+3AG6A80HQJ3As6dk6ctn1WgBbwC1wlomoBnTRpZR0RBNgHRDNgGyECSATYQbIQpgCMhDmgGiECyAS4QaIQrgCIhDuAG9ECMATEQbwQoQCliA+gF1J3YuOUSMcsADxA+xI6j5HjRTAAHHZvyO7lnQ/qrw/OA1QEzvvnAlgNZO115lWoHbmrM77A89a2jFh78iUAAAAAElFTkSuQmCC",alt:"",class:"left-arrow"},null,-1)])),right:a(()=>e[5]||(e[5]=[])),_:1}),s("div",Z,[i(S,{active:C.value,"onUpdate:active":e[0]||(e[0]=c=>C.value=c),"line-width":"3vw","line-height":"0.8vw",background:"transparent","title-active-color":"#e3e3e5"},{default:a(()=>[(n(),u(B,null,y(["剧集"],c=>i(d,{title:c,key:c},null,8,["title"])),64))]),_:1},8,["active"])]),s("div",$,[i(L,null,{default:a(()=>[(n(),u(B,null,y(["剧集"],c=>i(J,{key:c},{default:a(()=>[s("div",ee,[s("div",te,[i(I,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=t=>p.value=t),onRefresh:Q,"success-text":"刷新成功"},{default:a(()=>[i(D,{"immediate-check":!1,loading:A.value,"onUpdate:loading":e[1]||(e[1]=t=>A.value=t),finished:v.value,"finished-text":"没有更多了",onLoad:x,class:"series_list",error:f.value,"onUpdate:error":e[2]||(e[2]=t=>f.value=t),"error-text":"请求失败，点击重新加载"},{default:a(()=>[(n(!0),u(B,null,y(_.value,t=>(n(),k(h,{key:t.seriesShortId,style:{background:"#101012",padding:"0"},border:!1},{default:a(()=>[t.seriesShortId?(n(),k(b,{key:0,class:"flex",to:{name:E.value,params:{id:t.seriesShortId}}},{default:a(()=>[e[6]||(e[6]=s("div",{class:"select flex_none",style:{display:"none"}},[s("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAX9JREFUaEPtmb1KA0EUhb8JBEQDIsRSLazS7BsIi1aWVrGx9jX0BezzCFrYWgk+Qwq1sFBTmlLSBIwMEpzC2RnmZzeLd8vduXfPd87MLOwoWn6plutHAJpOUBKQBCIdqJ5CD4tjYATsRL4ntHwCnFOqO1sDF8B7g+KXmieUajcUYBFqXdK6UlmNdiUgAEmSkASS2BjRRBKIMC9JqSSQxMaIJpJAhHm20pM+DLfh7Bnmrs/lqiWgxV8PoNuB4SPcfDgcWiUAU/zFK1y+ecSbE6DYgKt9OH2C6bxaTJB43TInwH0Bh1sw/oSjsR0iWHxugH4XNETRs0NEic8NoPtXQUSLrwPABnGw+bvbeC/Yv5ZRzjVgvs9M4mUGe2s/W2WU+LoSWIKYEPpetPi6AczpdDv13Oddn4K6ppCpY70Dsy+XMs/nTQB4SvMbJgB+PuUbJQnk89avsyTg51O+Uf85gdb/Xm/5AUe+WZ2ss5xSJrMysJEkEGhcsjJJIJmVgY2+AQFptjFm78WRAAAAAElFTkSuQmCC",alt:"",style:{display:"none"}}),s("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAQ1JREFUaEPtmcENwkAMBG36gEagASrhGUfUgeI8qYQGoBHog0N55EfCaiMRnbR5e2/t2fPn4lb555X3bxpg7QSVgBJYSGD2CkWcj2bvaym2XehDyd3tZbY5ZV5uUwf8GKB9rtX82PAwRGa3owZomrYMQvdyyMwHhZEURcS+FL8P8r7vJkHPJjAOMHcA2R8kQ/w1AISSLFICCAESLiRD/LUDEEqySAkgBEi4kAzx1w5AKMkiJYAQIOFCMsRfOwChJIuUAEKAhAvJEH/tAISSLFICCAESLiRD/LUDEEqySAkgBEi4kAzx1w5AKMkiJVD9425E5c/r1f/gIHfvrzL9pfwr7i9mSkAJLCRQ/RX6AOwKGEBPows1AAAAAElFTkSuQmCC",alt:""})],-1)),s("div",se,[s("div",ae,[s("div",oe,[s("img",{class:"van-image__img",src:t.seriesCoverUrl,lazy:"loaded",style:{"object-fit":"fill"}},null,8,ne)])])]),s("div",le,[s("h2",null,g(t.seriesTitle),1),t.lastEpisodeNumber?(n(),u("p",re," 观看至"+g(t.lastEpisodeNumber<10?"0"+t.lastEpisodeNumber:t.lastEpisodeNumber)+"集 ",1)):(n(),u("p",ie,"未观看")),s("p",null,g(t.lastVisitTime),1),s("p",null," 播放进度"+g(U(t.durationSeconds)),1)])]),_:2,__:[6]},1032,["to"])):N("",!0)]),_:2},1024))),128))]),_:1},8,["loading","finished","error"])]),_:1},8,["modelValue"])])])]),_:2},1024)),64))]),_:1})])])}}}),he=Y(Ae,[["__scopeId","data-v-0d564839"]]);export{he as default};
