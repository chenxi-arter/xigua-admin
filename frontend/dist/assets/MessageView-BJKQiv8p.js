import{d as C,r as m,b as i,c as f,w as g,F as N,e as T,f as s,t as M,y as L,o,_ as B,j as x}from"./index-Cww4tW-9.js";import{T as U,a as $}from"./index-DKjtwpor.js";import"./index-__0INs8X.js";import{N as D}from"./index-CmeDyoSN.js";import{P as R}from"./index-BPInk1DG.js";import{L as F}from"./index-D1BXTva8.js";import{s as I}from"./request-VfYaw6rx.js";import"./index-B9NUlCX-.js";import"./use-id-B04f3oVk.js";import"./index-Vp1kQzfE.js";import"./use-route-KzbCpOCF.js";import"./use-placeholder-CoQhLr7Y.js";const P="/static/img/1.png",j={class:"msg-space"},z={class:"item-medi"},A={class:"nickname"},E={class:"info"},S={key:0},q={key:1},G={class:"time"},H={class:"item-right"},J=["src"],K=C({__name:"MsgComp",props:{active:{}},setup(b){const r=m(!1),l=m(!1),p=m(!1),v=m([]),c=b,_=async()=>{let a="";c.active==0?a="/api/notifications/unread":c.active==1?a="/api/video/episode/my-unread-replies":c.active==2&&(a="/api/video/comment/my-unread-likes");const e=Math.floor(v.value.length/20)+1;try{const n=await I.get(a,{params:{page:e,size:20}}),u=n.data.data.list||n.data.list;v.value.push(...u),u.length<20&&(l.value=!0)}catch(n){console.error(n)}},h=async()=>{await _(),l.value=!0},y=async()=>{v.value=[],l.value=!1,await _(),p.value=!1},d=a=>{const e=new Date(a),u=new Date().getTime()-e.getTime(),t=Math.floor(u/1e3),w=Math.floor(t/60),k=Math.floor(w/60),V=Math.floor(k/24);return V>0?`${V}天前`:k>0?`${k}小时前`:w>0?`${w}分钟前`:"刚刚"};return(a,e)=>{const n=F,u=R;return o(),i("div",j,[f(u,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=t=>p.value=t),onRefresh:y},{default:g(()=>[f(n,{loading:r.value,"onUpdate:loading":e[0]||(e[0]=t=>r.value=t),finished:l.value,"finished-text":"没有更多了",onLoad:h},{default:g(()=>[(o(!0),i(N,null,T(v.value,t=>(o(),i("div",{class:"msg-item",key:t.id},[e[4]||(e[4]=s("div",{class:"item-left"},[s("img",{src:P,alt:""})],-1)),s("div",z,[s("div",A,M(t.fromNickname),1),s("div",E,[a.active==1||t.type=="reply"?(o(),i("div",S,[e[2]||(e[2]=s("span",null,"评论了你:",-1)),s("span",null,M(t.content),1)])):a.active==2||t.type=="like"?(o(),i("div",q,e[3]||(e[3]=[s("span",null,"点赞了你的评论",-1)]))):L("",!0),s("span",G,M(d(t.createdAt)),1)])]),s("div",H,[s("img",{src:t.seriesCoverUrl,alt:""},null,8,J)])]))),128))]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"])])}}}),O=B(K,[["__scopeId","data-v-ca5fd5d3"]]),Q=C({__name:"MessageView",setup(b){const r=m(0),l=m(["全部","评论","点赞"]),p=()=>{};return(v,c)=>{const _=D,h=$,y=U;return o(),i("div",null,[f(_,{class:"msg-nav",title:"我的消息","left-arrow":"",onClickLeft:p}),f(y,{active:r.value,"onUpdate:active":c[0]||(c[0]=d=>r.value=d),shrink:"","line-width":"3vw",background:"#1c1c1d","title-inactive-color":"white","title-active-color":"white"},{default:g(()=>[(o(!0),i(N,null,T(l.value,d=>(o(),x(h,{title:d,key:d},{default:g(()=>[f(O,{active:r.value},null,8,["active"])]),_:2},1032,["title"]))),128))]),_:1},8,["active"])])}}}),le=B(Q,[["__scopeId","data-v-cfc6ab9a"]]);export{le as default};
