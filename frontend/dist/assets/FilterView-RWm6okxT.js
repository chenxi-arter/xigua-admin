import{d as X,r as n,a as F,u as M,k as Y,b as p,f as s,t as B,c as g,w as u,p as I,F as b,e as w,i as C,q as L,o as r,_ as S}from"./index-lUv6_swH.js";import{P as V}from"./index-DmuP6743.js";import{L as j}from"./index-BZEwXh_z.js";import{R as J,C as P}from"./CoverComp.vue_vue_type_style_index_0_scoped_cf7d3d33_lang-cC11Ef2n.js";import{T as z,a as Z}from"./index-CFBjzU4G.js";import"./index-C5FQimAv.js";import{s as E}from"./request-B8v40l10.js";import{C as K}from"./CoverComp-BD22qoZp.js";import"./index-D4ij0GdL.js";import"./use-id-rkaB3SDM.js";import"./use-route-DpZiaARC.js";const W={class:"channel_navigation flex h_100_vh flex_direction-column"},$={class:"nav-bar relative van-hairline--bottom"},ee={class:"center flex_auto"},ae={class:"flex_auto page_content relative"},te={class:"load-box"},se={class:"scroll-box"},oe={class:"overflow-hidden"},le={class:"load-box bottom_load_box"},ne=X({__name:"FilterView",setup(re){const x=n(1),_=n(!1),f=I(),c=M(),o=F({get:()=>({channeid:c.query.channeid,ids:c.query.ids,page:c.query.page?Number(c.query.page):x.value,size:20}),set:e=>{e.page!==void 0&&(x.value=e.page)}}),m=n([]),l=n(!1),d=n(!1),h=n(),i=n([]),y=n({list:[]}),A=async()=>{try{const e=await E.get("/api/list/getfiltersdata",{params:o.value}),a=e.data.data?.list?.length??0;d.value=a===0||a<o.value.size,i.value.push(...e.data.data?.list??[])}catch(e){console.error("失败：",e),_.value=!0,o.value.page--}},R=async()=>{d.value=!1,o.value.page=1,i.value=[],await A(),h.value=!1},Q=async()=>{d.value=!1,o.value.page=1,o.value.ids=m.value.map((e,a)=>y.value.list[a]?.list[e]?.index??0).join(","),f.replace({query:{...c.query,ids:o.value.ids}}),i.value=[],l.value=!0,await A(),l.value=!1},D=async()=>{l.value=!0,o.value.page++,await A(),l.value=!1};Y(async()=>{if(!f.options.history.state.forward||!i.value.length){d.value=!1,m.value=o.value.ids.split(",").map(e=>Number(e)),o.value.page=1,i.value=[],l.value=!0,await A(),l.value=!1;try{const e=await E.get("/api/list/getfilterstags");y.value=e.data.data}catch(e){console.error("失败：",e)}}});const N=()=>{window.history.state?.back?f.back():f.push("/")};return(e,a)=>{const O=Z,U=z,q=P,G=J,H=j,T=V;return r(),p("div",W,[s("div",$,[s("div",{class:"left",onClick:N},a[3]||(a[3]=[s("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAXNJREFUaEPt2TtKBEEYReFzMZMBd+ASXIGBmhgaGbkDlyGGJgYuQBAjAzP3YOoCRMHcRMTEkoYOOpgHXfU/ZrArmWD6cb6qoXqgxYYPbXg/EyB7BacV+LcrUEqZAXfAEXAl6aJmMlJ+Qn38E7DfR/8CM0nfYxHhgDnxXfOLpL2x8d3xoYAF8a/AoaS3tQZ4xIetgFd8CMAz3h3gHe8KiIh3AyyJP5D0XrPbLDrHfBuNjDdfgeh4U0BGvBkgK94EkBnfDMiObwKsQ3wr4BE4GezP3b9K831+1TOj+jlQSvkCtgc3OJX0sOqG1t+3AG6A80HQJ3As6dk6ctn1WgBbwC1wlomoBnTRpZR0RBNgHRDNgGyECSATYQbIQpgCMhDmgGiECyAS4QaIQrgCIhDuAG9ECMATEQbwQoQCliA+gF1J3YuOUSMcsADxA+xI6j5HjRTAAHHZvyO7lnQ/qrw/OA1QEzvvnAlgNZO115lWoHbmrM77A89a2jFh78iUAAAAAElFTkSuQmCC",alt:"",class:"left-arrow"},null,-1)])),s("div",ee,B(i.value?.[0]?.type),1),a[4]||(a[4]=s("div",{class:"right"},null,-1))]),s("div",ae,[s("div",te,[s("div",se,[g(T,{modelValue:h.value,"onUpdate:modelValue":a[2]||(a[2]=t=>h.value=t),onRefresh:R,"success-text":"刷新成功"},{default:u(()=>[s("div",oe,[(r(!0),p(b,null,w(y.value.list,(t,k)=>(r(),p("div",{class:"tabs",key:t.name},[g(U,{active:m.value[k],"onUpdate:active":v=>m.value[k]=v,onChange:Q,role:""},{default:u(()=>[(r(!0),p(b,null,w(t.list,v=>(r(),C(O,{key:v.classifyId},{title:u(()=>[s("span",null,B(v.classifyName=="全部"?"最近上传":v.classifyName),1)]),_:2},1024))),128))]),_:2},1032,["active","onUpdate:active"])]))),128)),s("div",le,[g(H,{loading:l.value,"onUpdate:loading":a[0]||(a[0]=t=>l.value=t),"immediate-check":!1,finished:d.value,error:_.value,"onUpdate:error":a[1]||(a[1]=t=>_.value=t),"error-text":"请求失败，点击重新加载","finished-text":"没有更多了",onLoad:D,class:"list",role:""},{default:u(()=>[g(G,{gutter:"10"},{default:u(()=>[(r(!0),p(b,null,w(i.value,t=>(r(),C(q,{key:t.id,span:"8"},{default:u(()=>[t.shortId?(r(),C(K,{key:0,MvItem:t,islist:!1},null,8,["MvItem"])):L("",!0)]),_:2},1024))),128))]),_:1})]),_:1},8,["loading","finished","error"])])])]),_:1},8,["modelValue"])])])])])}}}),he=S(ne,[["__scopeId","data-v-63176a2e"]]);export{he as default};
