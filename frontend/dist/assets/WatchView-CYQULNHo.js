import{d as M,r as t,n as V,l as N,j as C,o as d,w as s,f as x,c as n,b as k,F as T,e as z,t as I,A as H,q as P,x as O}from"./index-DGRSxoZl.js";import{T as j,a as q}from"./index-CIObagfB.js";import"./index-WGr52R86.js";import{L as E,s as A}from"./request-DkCCw_2P.js";import{P as $}from"./index-CFdQtazZ.js";import{L as B}from"./index-4z1t7u52.js";import{R as G,C as J}from"./index-ckLCxFa1.js";import{I as K}from"./index-DOxR4TSx.js";import{C as Q}from"./index-DP6iCI0-.js";import"./index-DrUHyDOI.js";import"./use-id-C7Xw1B3H.js";import"./index-BVyrDdmv.js";import"./use-route-BtIsO7a1.js";const X={class:"video-info"},Y={style:{color:"white","font-size":"13px"}},R=M({__name:"ScCatComp",props:{cid:{},type:{}},setup(U){const f=t(!1),p=t(!1),_=t(!1),h=t(!1),c=t(),m=t(0),g=U,i=t([]),o=t("");V(()=>{/iphone|ipod|android|blackberry|windows phone/i.test(navigator.userAgent.toLowerCase())?o.value="seriesPlay":o.value="play"}),N(()=>{P(()=>{c.value&&(c.value.scrollTop=m.value)})});const r=async()=>{i.value=[],await S(),_.value=!1},v=()=>{m.value=c.value.scrollTop},e=async()=>{p.value=!0,await S(),p.value=!1},S=async()=>{try{let a="";g.type==1?a="/api/user/favorites":a="/api/user/liked";const u=await A.get(a,{params:{page:Math.floor(i.value.length/20)+1,size:20,categoryId:g.cid}}),b=u.data.data||u.data,{list:L,total:l}=b;i.value.push(...L),i.value.length>=l&&(f.value=!0)}catch(a){console.error(a),h.value=!0}},w=async a=>{H.push({name:o.value,params:{id:a}})};return(a,u)=>{const b=E,L=K,l=J,F=G,W=B,D=$;return d(),C(D,{modelValue:_.value,"onUpdate:modelValue":u[2]||(u[2]=y=>_.value=y),onRefresh:r,"success-text":"刷新成功",style:{padding:"12px"}},{default:s(()=>[x("div",{class:"watch-scroll-box",ref_key:"watchListContainer",ref:c,onScroll:v},[n(W,{loading:p.value,"onUpdate:loading":u[0]||(u[0]=y=>p.value=y),finished:f.value,error:h.value,"onUpdate:error":u[1]||(u[1]=y=>h.value=y),"error-text":"请求失败，点击重新加载","finished-text":"没有更多了",onLoad:e,class:"watch-list",role:""},{default:s(()=>[n(F,{gutter:[12,12]},{default:s(()=>[(d(!0),k(T,null,z(i.value,y=>(d(),C(l,{key:y.seriesId,span:"8",onClick:se=>w(y.seriesShortId)},{default:s(()=>[x("div",X,[n(L,{fit:"contain",src:y.seriesCoverUrl},{loading:s(()=>[n(b,{type:"spinner",size:"20"})]),_:2},1032,["src"]),x("div",Y,I(y.seriesTitle),1)])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1},8,["loading","finished","error"])],544)]),_:1},8,["modelValue"])}}}),Z=["src"],ee={class:"reply"},te=M({__name:"LsCatComp",props:{cid:{}},setup(U){const f=t(!1),p=t(!1),_=t(!1),h=U,c=t([]),m=t(),g=t(0),i=t("");V(()=>{/iphone|ipod|android|blackberry|windows phone/i.test(navigator.userAgent.toLowerCase())?i.value="seriesPlay":i.value="play"}),N(()=>{P(()=>{m.value&&(m.value.scrollTop=g.value)})});const o=async()=>{f.value=!0,await v(),f.value=!1},r=()=>{g.value=m.value.scrollTop},v=async()=>{try{const w=await A.get("/api/video/browse-history",{params:{page:Math.floor(c.value.length/20)+1,size:20,categoryId:h.cid}}),a=w.data.data||w.data,{list:u,total:b}=a;c.value.push(...u),c.value.length>=b&&(p.value=!0)}catch(w){console.error(w),_.value=!0}},e=t(!1),S=async()=>{c.value=[],await v(),e.value=!1};return(w,a)=>{const u=Q,b=B,L=$;return d(),C(L,{modelValue:e.value,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value=l),onRefresh:S,"success-text":"刷新成功",style:{padding:"12px"}},{default:s(()=>[x("div",{class:"watch-scroll-box",ref_key:"historyListContainer",ref:m,onScroll:r},[n(b,{loading:f.value,"onUpdate:loading":a[0]||(a[0]=l=>f.value=l),finished:p.value,error:_.value,"onUpdate:error":a[1]||(a[1]=l=>_.value=l),"error-text":"请求失败，点击重新加载","finished-text":"没有更多了",class:"history-list",onLoad:o,"immediate-check":!1,style:{height:"100%"}},{default:s(()=>[(d(!0),k(T,null,z(c.value,l=>(d(),C(u,{key:l.seriesId,"is-link":"",center:"",border:!1,to:{name:i.value,params:{id:l.seriesShortId}},"title-style":{color:"white"},style:{padding:"10px 4px"}},{title:s(()=>[O(I(l.seriesTitle),1)]),icon:s(()=>[x("img",{src:l.seriesCoverUrl,alt:"",style:{width:"64px",height:"86px",margin:"0 13px 0 0"}},null,8,Z)]),label:s(()=>[a[3]||(a[3]=x("span",{style:{color:"black"}},null,-1)),x("span",ee,I(l.watchStatus),1)]),_:2},1032,["to"]))),128))]),_:1},8,["loading","finished","error"])],544)]),_:1},8,["modelValue"])}}}),ae={class:"watch-contain"},_e=M({__name:"WatchView",setup(U){const f=t(0),p=t([{name:"全部",id:null}]),_=async()=>{try{const o=(await A.get("/api/home/categories")).data.sort((r,v)=>r.id-v.id).map(r=>({...r,isMounted:!1}));p.value.push(...o)}catch(i){console.error(i)}},h=t("");V(()=>{_(),/iphone|ipod|android|blackberry|windows phone/i.test(navigator.userAgent.toLowerCase())?h.value="seriesPlay":h.value="play"});const c=t(0),m=t(0),g=t(0);return(i,o)=>{const r=q,v=j;return d(),k("div",ae,[n(v,{"lazy-render":!1,active:f.value,"onUpdate:active":o[3]||(o[3]=e=>f.value=e),swipeable:"",shrink:"",background:"rgba(101, 102, 102, 0.0)","title-active-color":"white","line-width":"20px"},{default:s(()=>[n(r,{title:"我的收藏","title-style":"font-size: 16px"},{default:s(()=>[n(v,{"lazy-render":!1,active:c.value,"onUpdate:active":o[0]||(o[0]=e=>c.value=e),type:"card",class:"sc-cat-tabs"},{default:s(()=>[(d(!0),k(T,null,z(p.value,e=>(d(),C(r,{title:e.name,key:e.name,class:"tab-item"},{default:s(()=>[n(R,{type:1,cid:e.id},null,8,["cid"])]),_:2},1032,["title"]))),128))]),_:1},8,["active"])]),_:1}),n(r,{title:"我的点赞","title-style":"font-size: 16px"},{default:s(()=>[n(v,{"lazy-render":!1,active:m.value,"onUpdate:active":o[1]||(o[1]=e=>m.value=e),shrink:"",type:"card",class:"sc-cat-tabs"},{default:s(()=>[(d(!0),k(T,null,z(p.value,e=>(d(),C(r,{title:e.name,key:e.name,class:"tab-item"},{default:s(()=>[n(R,{type:2,cid:e.id},null,8,["cid"])]),_:2},1032,["title"]))),128))]),_:1},8,["active"])]),_:1}),n(r,{title:"播放历史","title-style":"font-size: 16px"},{default:s(()=>[n(v,{"lazy-render":!1,active:g.value,"onUpdate:active":o[2]||(o[2]=e=>g.value=e),shrink:"",type:"card",class:"sc-cat-tabs"},{default:s(()=>[(d(!0),k(T,null,z(p.value,e=>(d(),C(r,{title:e.name,key:e.name,class:"tab-item"},{default:s(()=>[n(te,{cid:e.id},null,8,["cid"])]),_:2},1032,["title"]))),128))]),_:1},8,["active"])]),_:1})]),_:1},8,["active"])])}}});export{_e as default};
