import{d as V,r as p,b as i,c as f,w as h,F as N,e as $,f as a,t as M,y as B,A as L,o,_ as T,j as x}from"./index-m9kgVP5a.js";import{T as I,a as S}from"./index-BvptoIOJ.js";import"./index-edwCfcYJ.js";import{N as D}from"./index-DD2TlhdQ.js";import{P as R}from"./index-eVkH5_MO.js";import{L as A}from"./index-DIQNMNHc.js";import{s as F}from"./request-DZHTuLH4.js";import"./index-BZTagvbl.js";import"./use-id-BAoJdedn.js";import"./index-B23_Qd3X.js";import"./use-route-DOAbL3fG.js";import"./use-placeholder-E-vqc_vo.js";const P="/static/img/1.png",j={class:"msg-space"},z=["onClick"],E={class:"item-medi"},q={class:"nickname"},G={class:"info"},H={key:0},J={key:1},K={class:"time"},O={class:"item-right"},Q=["src"],W=V({__name:"MsgComp",props:{active:{}},setup(C){const r=p(!1),l=p(!1),m=p(!1),v=p([]),c=C,_=async()=>{let s="";c.active==0?s="/api/notifications/unread":c.active==1?s="/api/video/episode/my-unread-replies":c.active==2&&(s="/api/video/comment/my-unread-likes");const t=Math.floor(v.value.length/20)+1;try{const n=await F.get(s,{params:{page:t,size:20}}),u=n.data.data.list||n.data.list;v.value.push(...u),u.length<20&&(l.value=!0)}catch(n){console.error(n)}},k=async()=>{await _(),l.value=!0},w=async()=>{v.value=[],l.value=!1,await _(),m.value=!1},d=s=>{const t=new Date(s),u=new Date().getTime()-t.getTime(),e=Math.floor(u/1e3),g=Math.floor(e/60),y=Math.floor(g/60),b=Math.floor(y/24);return b>0?`${b}天前`:y>0?`${y}小时前`:g>0?`${g}分钟前`:"刚刚"},U=s=>{L.push(`/series/${s.seriesShortId}?eid=${s.episodeShortId}&cmtShow=true`)};return(s,t)=>{const n=A,u=R;return o(),i("div",j,[f(u,{modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=e=>m.value=e),onRefresh:w},{default:h(()=>[f(n,{loading:r.value,"onUpdate:loading":t[0]||(t[0]=e=>r.value=e),finished:l.value,"finished-text":"没有更多了",onLoad:k},{default:h(()=>[(o(!0),i(N,null,$(v.value,e=>(o(),i("div",{class:"msg-item",key:e.id,onClick:g=>U(e)},[t[4]||(t[4]=a("div",{class:"item-left"},[a("img",{src:P,alt:""})],-1)),a("div",E,[a("div",q,M(e.fromNickname||e.fromUsername||e.likerNickname||e.likerUsername),1),a("div",G,[s.active==1||e.type=="reply"?(o(),i("div",H,[t[2]||(t[2]=a("span",null,"评论了你:",-1)),a("span",null,M(e.content),1)])):s.active==2||e.type=="like"?(o(),i("div",J,t[3]||(t[3]=[a("span",null,"点赞了你的评论",-1)]))):B("",!0),a("span",K,M(d(e.createdAt)),1)])]),a("div",O,[a("img",{src:e.seriesCoverUrl,alt:""},null,8,Q)])],8,z))),128))]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"])])}}}),X=T(W,[["__scopeId","data-v-27401fe5"]]),Y=V({__name:"MessageView",setup(C){const r=p(0),l=p(["全部","评论","点赞"]),m=()=>{};return(v,c)=>{const _=D,k=S,w=I;return o(),i("div",null,[f(_,{class:"msg-nav",title:"我的消息","left-arrow":"",onClickLeft:m}),f(w,{active:r.value,"onUpdate:active":c[0]||(c[0]=d=>r.value=d),shrink:"","line-width":"3vw",background:"#1c1c1d","title-inactive-color":"white","title-active-color":"white"},{default:h(()=>[(o(!0),i(N,null,$(l.value,d=>(o(),x(k,{title:d,key:d},{default:h(()=>[f(X,{active:r.value},null,8,["active"])]),_:2},1032,["title"]))),128))]),_:1},8,["active"])])}}}),ue=T(Y,[["__scopeId","data-v-cfc6ab9a"]]);export{ue as default};
