import{I as Oe,j as e}from"./index-Bga7-WXN.js";import{r as i,k as st}from"./react-vendor-BZ8KDC-J.js";import{E as k,S as it,a as ze}from"./admin-BuVr2CaF.js";import{f as Q}from"./format-0Cj3JWJt.js";import{q as nt,F as T,s as f,T as ot,a as I,B as S,f as V,p as Y,g as lt,b as G,i as u,j as Ee,I as rt,U as at}from"./antd-vendor-aNvYRewR.js";import{R as Me}from"./CopyOutlined-BBTI9cnG.js";import{R as dt}from"./DownloadOutlined-BoVntQYy.js";import"./client-BbHh6MVO.js";import"./utils-vendor-NIGUFBhG.js";function ue(){return ue=Object.assign?Object.assign.bind():function(m){for(var h=1;h<arguments.length;h++){var w=arguments[h];for(var j in w)Object.prototype.hasOwnProperty.call(w,j)&&(m[j]=w[j])}return m},ue.apply(this,arguments)}const ct=(m,h)=>i.createElement(Oe,ue({},m,{ref:h,icon:nt})),ut=i.forwardRef(ct);var pt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};function pe(){return pe=Object.assign?Object.assign.bind():function(m){for(var h=1;h<arguments.length;h++){var w=arguments[h];for(var j in w)Object.prototype.hasOwnProperty.call(w,j)&&(m[j]=w[j])}return m},pe.apply(this,arguments)}const ft=(m,h)=>i.createElement(Oe,pe({},m,{ref:h,icon:pt})),ht=i.forwardRef(ft),{Paragraph:P,Text:b}=u,xt=m=>{const h=Math.floor(m/3600),w=Math.floor(m%3600/60),j=m%60;return h>0?`${h}æ—¶${w}åˆ†${j}ç§’`:w>0?`${w}åˆ†${j}ç§’`:`${j}ç§’`};function Ct(){const[m]=st(),h=Number(m.get("seriesId")||"")||void 0,[w,j]=i.useState(!1),[$e,De]=i.useState([]),[Ve,Be]=i.useState(0),[X,Le]=i.useState(1),[Z,Pe]=i.useState(10),fe=i.useRef(1),J=i.useRef(10);i.useEffect(()=>{fe.current=X},[X]),i.useEffect(()=>{J.current=Z},[Z]);const[ee,E]=i.useState(!1),[o,F]=i.useState(null),[v]=T.useForm(),[Fe,te]=i.useState(!1),[A,se]=i.useState(null),[Ae,ie]=i.useState(!1),[q,ne]=i.useState(null),[R,qe]=i.useState(h),[U,oe]=i.useState([]),he=i.useRef([]);i.useEffect(()=>{he.current=U},[U]);const[M,xe]=i.useState(!1),[ye,me]=i.useState(1),[ge,je]=i.useState(!0),O=i.useRef(void 0),le=i.useRef(""),re=i.useRef(1),[He,H]=i.useState(!1),[g,Ne]=i.useState(null),[Ke,ve]=i.useState(!1),[N,we]=i.useState(void 0),[K,be]=i.useState(void 0),[ae,Se]=i.useState(!1),[de,ce]=i.useState(0),[$,We]=i.useState("720p"),B=i.useRef(!1),_e=async t=>{const s=Array.from(new Set(t.filter(n=>typeof n=="number")));if(s.length===0)return;const l=new Set(he.current.map(n=>n.value)),r=s.filter(n=>!l.has(n));if(r.length!==0)try{const n=await Promise.all(r.map(async a=>{try{const p=await ze.get(a),d=`#${a}${p?.title?` ${p.title}`:""}`;return{value:a,label:d}}catch{return{value:a,label:`#${a}`}}}));n.length>0&&oe(a=>Array.from(new Map([...a,...n].map(p=>[p.value,p])).values()))}catch{}},C=i.useCallback(async(t,s)=>{const l=t??fe.current,r=s??J.current;j(!0);try{const n={};R&&(n.seriesId=R),N!==void 0&&(n.minDuration=N),K!==void 0&&(n.maxDuration=K);const a=await k.list(l,r,n),p=(a.items||[]).slice().sort((d,x)=>d.seriesId!==x.seriesId?d.seriesId-x.seriesId:d.episodeNumber-x.episodeNumber);De(p),Be(a.total),Le(a.page),Pe(a.size),_e(p.map(d=>d.seriesId))}finally{j(!1)}},[R,N,K]);i.useEffect(()=>{C(1,J.current)},[C]);const W=50,z=i.useCallback(async t=>{const s=t?.keyword!==void 0?t.keyword:le.current,l=t?.reset?1:t?.page||re.current;xe(!0);try{if(s&&s.trim()){const n=await it.fuzzy({keyword:s.trim(),page:l,size:W}),a=n?.data||n,d=(a?.list||a?.items||[]).map(L=>({value:L.id,label:`#${L.id} ${L.title||""}`}));oe(L=>t?.reset?d:Array.from(new Map([...L,...d].map(Ue=>[Ue.value,Ue])).values()));const x=a?.page||l;me(x),re.current=x;const c=a?.total??0,y=a?.size??W;je(x*y<c||a?.hasMore===!0)}else{const n=await ze.list(l,W),a=(n.items||[]).map(y=>({value:y.id,label:`#${y.id} ${y.title||""}`}));oe(y=>t?.reset?a:Array.from(new Map([...y,...a].map(D=>[D.value,D])).values()));const p=n.page||l;me(p),re.current=p;const d=n.total??0,x=n.size??W;je(p*x<d)}const r=t?.keyword!==void 0?t.keyword:le.current;le.current=r||""}catch{}finally{xe(!1)}},[]);i.useEffect(()=>{z({reset:!0})},[z]);const _=i.useRef(null);i.useEffect(()=>{B.current||o&&_.current===o.id||o&&ee&&(v.setFieldsValue(o),_.current=o.id)},[o,ee,v]);const Te=i.useCallback(async t=>{try{const s=await k.get(t.id);F(s),v.setFieldsValue(s),_.current=s.id,E(!0)}catch(s){console.error("è·å–å‰§é›†è¯¦æƒ…å¤±è´¥:",s),F(t),v.setFieldsValue(t),_.current=t.id,E(!0)}},[v]),Ce=i.useCallback(t=>{se(t),te(!0)},[]),Qe=i.useCallback(async()=>{if(A)try{await k.remove(A.id),f.success("å·²åˆ é™¤"),C()}catch{f.error("åˆ é™¤å¤±è´¥")}finally{te(!1),se(null)}},[A,C]),Ye=i.useCallback(()=>{te(!1),se(null)},[]),Ge=i.useCallback(async()=>{if(!(!o||!q))try{await k.update(o.id,q),f.success("å·²æ›´æ–°"),E(!1),C()}catch{f.error("ä¿®æ”¹å¤±è´¥")}finally{ie(!1),ne(null)}},[o,q,C]),Xe=i.useCallback(()=>{ie(!1),ne(null)},[]),ke=i.useCallback(async t=>{ve(!0),H(!0);try{const s=await k.getDownloadUrls(t.id);Ne(s)}catch{f.error("è·å–ä¸‹è½½åœ°å€å¤±è´¥"),H(!1)}finally{ve(!1)}},[]),Ie=i.useCallback((t,s)=>{const l=document.createElement("a");l.href=t,l.download=s,l.target="_blank",document.body.appendChild(l),l.click(),document.body.removeChild(l)},[]),Re=i.useCallback(t=>new Promise((s,l)=>{const r=document.createElement("video");r.preload="metadata",r.onloadedmetadata=()=>{window.URL.revokeObjectURL(r.src);const n=Math.round(r.duration),a=r.videoHeight>r.videoWidth;console.log("[è§†é¢‘å…ƒæ•°æ®]",{duration:n+"ç§’",width:r.videoWidth,height:r.videoHeight,isVertical:a?"ç«–å±":"æ¨ªå±"}),s({duration:n,isVertical:a})},r.onerror=()=>{window.URL.revokeObjectURL(r.src),l(new Error("æ— æ³•è¯»å–è§†é¢‘å…ƒæ•°æ®"))},r.src=window.URL.createObjectURL(t)}),[]),Ze=i.useCallback(async t=>{const{file:s,onSuccess:l,onError:r}=t;if(!o){f.warning("è¯·å…ˆåˆ›å»ºå‰§é›†ï¼Œåˆ›å»ºå®Œæˆåå¯åœ¨ç¼–è¾‘é¡µé¢ä¸Šä¼ è§†é¢‘"),r?.(new Error("æ–°å»ºæ¨¡å¼ä¸æ”¯æŒæ–‡ä»¶ä¸Šä¼ "));return}try{Se(!0),ce(0),B.current=!0;const n=s;try{const d=await Re(n);v.setFieldsValue({duration:d.duration,isVertical:d.isVertical}),f.success(`å·²è‡ªåŠ¨è¯†åˆ«ï¼šæ—¶é•¿${d.duration}ç§’ï¼Œ${d.isVertical?"ç«–å±":"æ¨ªå±"}`)}catch(d){console.warn("[è§†é¢‘å…ƒæ•°æ®] æå–å¤±è´¥:",d),f.warning("æ— æ³•è‡ªåŠ¨è¯†åˆ«è§†é¢‘ä¿¡æ¯ï¼Œè¯·æ‰‹åŠ¨å¡«å†™")}if(!["video/mp4","video/mpeg","video/quicktime","video/x-msvideo","video/webm"].includes(n.type))throw new Error("ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹ï¼Œè¯·ä¸Šä¼  MP4ã€MOVã€AVI æˆ– WebM è§†é¢‘");console.log("[è§†é¢‘ä¸Šä¼ ] å¼€å§‹è·å–é¢„ç­¾å URL",{episodeId:o.id,filename:n.name,contentType:n.type,quality:$,fileSize:n.size});const p=await k.getPresignedUploadUrl(o.id,{filename:n.name,contentType:n.type||"video/mp4",quality:$});console.log("[è§†é¢‘ä¸Šä¼ ] è·å–é¢„ç­¾å URL æˆåŠŸ",p),await new Promise((d,x)=>{const c=new XMLHttpRequest;c.upload.addEventListener("progress",y=>{if(y.lengthComputable){const D=Math.round(y.loaded/y.total*100);ce(D),console.log("[è§†é¢‘ä¸Šä¼ ] è¿›åº¦:",D+"%")}}),c.addEventListener("load",()=>{if(console.log("[è§†é¢‘ä¸Šä¼ ] è¯·æ±‚å®Œæˆ",{status:c.status,statusText:c.statusText,responseText:c.responseText}),c.status===200||c.status===204)console.log("[è§†é¢‘ä¸Šä¼ ] ä¸Šä¼ åˆ° R2 æˆåŠŸ"),d();else{const y=`ä¸Šä¼ å¤±è´¥ (çŠ¶æ€ç : ${c.status})${c.responseText?": "+c.responseText:""}`;console.error("[è§†é¢‘ä¸Šä¼ ] å¤±è´¥:",y),x(new Error(y))}}),c.addEventListener("error",y=>{console.error("[è§†é¢‘ä¸Šä¼ ] ç½‘ç»œé”™è¯¯:",y),console.error("[è§†é¢‘ä¸Šä¼ ] å¯èƒ½çš„åŸå› : CORS é…ç½®é—®é¢˜ã€ç½‘ç»œä¸­æ–­ã€æˆ– R2 è®¿é—®æƒé™é—®é¢˜"),x(new Error("ä¸Šä¼ å¤±è´¥ï¼šç½‘ç»œé”™è¯¯æˆ– CORS é…ç½®é—®é¢˜"))}),c.addEventListener("abort",()=>{console.warn("[è§†é¢‘ä¸Šä¼ ] ä¸Šä¼ å·²å–æ¶ˆ"),x(new Error("ä¸Šä¼ å·²å–æ¶ˆ"))}),console.log("[è§†é¢‘ä¸Šä¼ ] å¼€å§‹ä¸Šä¼ åˆ° R2",{url:p.uploadUrl.substring(0,100)+"...",contentType:n.type||"video/mp4"}),c.open("PUT",p.uploadUrl),c.setRequestHeader("Content-Type",n.type||"video/mp4"),c.send(n)}),await k.notifyUploadComplete(o.id,{fileKey:p.fileKey,publicUrl:p.publicUrl,quality:$,fileSize:n.size});try{const d=await k.get(o.id),x=v.getFieldsValue();F(d),setTimeout(()=>{const c=x.duration||d.duration;v.setFieldsValue({...x,duration:c}),B.current=!1},100)}catch(d){console.error("[è§†é¢‘ä¸Šä¼ ] è·å–æ›´æ–°åçš„å‰§é›†ä¿¡æ¯å¤±è´¥:",d),setTimeout(()=>{B.current=!1},100)}f.success(`è§†é¢‘ä¸Šä¼ æˆåŠŸ (${$})`),l?.({})}catch(n){r?.(n instanceof Error?n:new Error(String(n))),f.error(`è§†é¢‘ä¸Šä¼ å¤±è´¥: ${n instanceof Error?n.message:String(n)}`),B.current=!1}finally{Se(!1),ce(0)}},[o,$,C,Re,v]),Je=i.useMemo(()=>[{title:"ID",dataIndex:"id",width:80},{title:"ç³»åˆ—",dataIndex:"seriesTitle",width:220,render:(t,s)=>s.seriesTitle||(()=>{const l=U.find(r=>r.value===s.seriesId);return l?l.label:`#${s.seriesId}`})()},{title:"é›†æ•°",dataIndex:"episodeNumber",width:80},{title:"æ ‡é¢˜",dataIndex:"title",width:200,ellipsis:{showTitle:!1},render:t=>e.jsx(ot,{placement:"topLeft",title:t,children:e.jsx("span",{children:t})})},{title:"æ—¶é•¿",dataIndex:"duration",width:110,render:t=>e.jsx("span",{title:`${t}ç§’`,children:xt(t)})},{title:"çŠ¶æ€",dataIndex:"status",width:100,render:t=>t==="published"?"å·²å‘å¸ƒ":t==="hidden"?"éšè—":t==="draft"?"è‰ç¨¿":t||"-"},{title:"æ–¹å‘",dataIndex:"isVertical",width:80,render:t=>t?"ç«–å±":"æ¨ªå±"},{title:"åˆ›å»ºæ—¶é—´",dataIndex:"createdAt",width:150,render:t=>Q(t)},{title:"æ›´æ–°æ—¶é—´",dataIndex:"updatedAt",width:150,render:t=>Q(t)},{title:"æ“ä½œ",width:280,render:(t,s)=>e.jsxs(I,{children:[e.jsx(S,{onClick:()=>Te(s),type:"link",children:"ç¼–è¾‘"}),e.jsx(S,{onClick:()=>ke(s),type:"link",children:"ä¸‹è½½"}),e.jsx(S,{onClick:()=>Ce(s),danger:!0,type:"link",children:"åˆ é™¤"})]})}],[U,Te,Ce,ke]),et=async()=>{if(F(null),v.resetFields(),R)try{const t=await k.list(1,1,{seriesId:R}),s=t.items&&t.items.length>0?Math.max(...t.items.map(l=>l.episodeNumber||0)):0;v.setFieldsValue({seriesId:R,episodeNumber:s+1})}catch{v.setFieldsValue({seriesId:R})}E(!0)},tt=async()=>{const t=await v.validateFields();if(o)ne(t),ie(!0);else try{await k.create(t),f.success("å·²åˆ›å»º"),E(!1),C()}catch{f.error("åˆ›å»ºå¤±è´¥")}};return e.jsxs("div",{className:"page",children:[e.jsxs(I,{className:"page-toolbar",wrap:!0,children:[e.jsx(S,{type:"primary",onClick:et,children:"æ–°å»ºå‰§é›†"}),e.jsx(S,{onClick:()=>C(),children:"åˆ·æ–°"}),e.jsx(V,{showSearch:!0,allowClear:!0,placeholder:"ç­›é€‰ç³»åˆ—",style:{width:280},filterOption:!1,options:U,value:R,loading:M,onDropdownVisibleChange:t=>{t&&U.length===0&&!M&&z({reset:!0})},onPopupScroll:t=>{const s=t.target,l=s&&s.scrollHeight-s.offsetHeight>0,r=s&&s.scrollTop+s.offsetHeight>=s.scrollHeight-20,n=s&&s.scrollTop>0;l&&r&&n&&ge&&!M&&z({page:ye+1})},onSearch:t=>{O.current&&window.clearTimeout(O.current),O.current=window.setTimeout(()=>{M||z({reset:!0,keyword:(t||"").trim()})},300)},onChange:t=>qe(t)}),e.jsx(Y,{placeholder:"æœ€å°æ—¶é•¿(ç§’)",style:{width:140},value:N,onChange:t=>we(t||void 0),min:0}),e.jsx("span",{style:{color:"#999"},children:"~"}),e.jsx(Y,{placeholder:"æœ€å¤§æ—¶é•¿(ç§’)",style:{width:140},value:K,onChange:t=>be(t||void 0),min:0}),e.jsx(S,{onClick:()=>{we(void 0),be(void 0)},children:"æ¸…é™¤æ—¶é•¿ç­›é€‰"})]}),e.jsx(lt,{rowKey:"id",loading:w,dataSource:$e,columns:Je,tableLayout:"fixed",scroll:{x:960},pagination:{current:X,pageSize:Z,total:Ve,position:["bottomCenter"],onChange:(t,s)=>C(t,s)}}),e.jsx(G,{title:o?"ç¼–è¾‘å‰§é›†":"æ–°å»ºå‰§é›†",open:ee,onCancel:()=>E(!1),onOk:tt,okText:"ä¿å­˜",cancelText:"å–æ¶ˆ",width:800,style:{top:20},children:e.jsxs("div",{style:{maxHeight:"70vh",overflowY:"auto",paddingRight:8},children:[o&&e.jsxs("div",{style:{background:"#f5f5f5",padding:"16px",borderRadius:"8px",marginBottom:"20px"},children:[e.jsx(u.Title,{level:5,style:{marginTop:0,marginBottom:12},children:"ğŸ“Š åªè¯»ä¿¡æ¯"}),e.jsxs(I,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(u.Text,{type:"secondary",children:"ID:"}),e.jsx(u.Text,{strong:!0,children:o.id})]}),o.shortId&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(u.Text,{type:"secondary",children:"Short ID:"}),e.jsxs(I,{children:[e.jsx(u.Text,{code:!0,children:o.shortId}),e.jsx(S,{size:"small",icon:e.jsx(Me,{}),onClick:()=>{navigator.clipboard.writeText(o.shortId||""),f.success("Short ID å·²å¤åˆ¶")}})]})]}),o.accessKey&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(u.Text,{type:"secondary",children:"Access Key:"}),e.jsxs(I,{children:[e.jsxs(u.Text,{code:!0,children:[o.accessKey.substring(0,8),"..."]}),e.jsx(S,{size:"small",icon:e.jsx(Me,{}),onClick:()=>{navigator.clipboard.writeText(o.accessKey||""),f.success("Access Key å·²å¤åˆ¶")}})]})]}),o.playCount!==void 0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(u.Text,{type:"secondary",children:"æ’­æ”¾æ¬¡æ•°:"}),e.jsx(u.Text,{strong:!0,children:o.playCount.toLocaleString()})]}),o.likeCount!==void 0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(u.Text,{type:"secondary",children:"ç‚¹èµæ•°:"}),e.jsx(u.Text,{strong:!0,children:o.likeCount.toLocaleString()})]}),o.dislikeCount!==void 0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(u.Text,{type:"secondary",children:"ç‚¹è¸©æ•°:"}),e.jsx(u.Text,{strong:!0,children:o.dislikeCount.toLocaleString()})]}),o.favoriteCount!==void 0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(u.Text,{type:"secondary",children:"æ”¶è—æ•°:"}),e.jsx(u.Text,{strong:!0,children:o.favoriteCount.toLocaleString()})]}),o.createdAt&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(u.Text,{type:"secondary",children:"åˆ›å»ºæ—¶é—´:"}),e.jsx(u.Text,{children:Q(o.createdAt)})]}),o.updatedAt&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(u.Text,{type:"secondary",children:"æ›´æ–°æ—¶é—´:"}),e.jsx(u.Text,{children:Q(o.updatedAt)})]})]})]}),e.jsxs(T,{form:v,layout:"vertical",children:[e.jsx(Ee,{orientation:"left",children:"ğŸ“„ åŸºæœ¬ä¿¡æ¯"}),e.jsx(T.Item,{name:"seriesId",label:"ç³»åˆ—",rules:[{required:!0,message:"è¯·é€‰æ‹©ç³»åˆ—"}],children:e.jsx(V,{showSearch:!0,allowClear:!0,placeholder:"æœç´¢ç³»åˆ—",filterOption:!1,options:U,loading:M,onDropdownVisibleChange:t=>{t&&U.length===0&&z({reset:!0})},onPopupScroll:t=>{const s=t.target,l=s&&s.scrollHeight-s.offsetHeight>0,r=s&&s.scrollTop+s.offsetHeight>=s.scrollHeight-20,n=s&&s.scrollTop>0;l&&r&&n&&ge&&!M&&z({page:ye+1})},onSearch:t=>{O.current&&window.clearTimeout(O.current),O.current=window.setTimeout(()=>{z({reset:!0,keyword:(t||"").trim()})},300)}})}),e.jsxs(I,{style:{width:"100%"},size:"middle",children:[e.jsx(T.Item,{name:"episodeNumber",label:"é›†æ•°",rules:[{required:!0,message:"è¯·è¾“å…¥é›†æ•°"}],style:{marginBottom:0,flex:1},children:e.jsx(Y,{style:{width:"100%"},placeholder:"é›†æ•°ç¼–å·",min:1})}),e.jsx(T.Item,{name:"duration",label:"æ—¶é•¿(ç§’)",rules:[{required:!0,message:"è¯·è¾“å…¥æ—¶é•¿"}],style:{marginBottom:0,flex:1},children:e.jsx(Y,{style:{width:"100%"},placeholder:"è§†é¢‘æ—¶é•¿ï¼ˆç§’ï¼‰",min:0})})]}),e.jsx(T.Item,{name:"title",label:"æ ‡é¢˜",rules:[{required:!0,message:"è¯·è¾“å…¥æ ‡é¢˜"}],children:e.jsx(rt,{placeholder:"å‰§é›†æ ‡é¢˜"})}),e.jsx(Ee,{orientation:"left",children:"ğŸ¬ æ’­æ”¾è®¾ç½®"}),e.jsxs(I,{style:{width:"100%"},size:"middle",children:[e.jsx(T.Item,{name:"status",label:"çŠ¶æ€",style:{marginBottom:0,flex:1},children:e.jsx(V,{placeholder:"é€‰æ‹©çŠ¶æ€",allowClear:!0,options:[{value:"published",label:"å·²å‘å¸ƒ"},{value:"hidden",label:"éšè—"},{value:"draft",label:"è‰ç¨¿"}]})}),e.jsx(T.Item,{name:"isVertical",label:"æ’­æ”¾æ–¹å‘",initialValue:!1,style:{marginBottom:0,flex:1},children:e.jsx(V,{placeholder:"é€‰æ‹©æ’­æ”¾æ–¹å‘",options:[{value:!1,label:"æ¨ªå±"},{value:!0,label:"ç«–å±"}]})})]}),e.jsx(T.Item,{name:"hasSequel",label:"æ˜¯å¦æœ‰ç»­é›†",children:e.jsx(V,{placeholder:"è¯·é€‰æ‹©",allowClear:!0,options:[{value:!0,label:"æ˜¯"},{value:!1,label:"å¦"}]})}),o&&e.jsx(T.Item,{label:"è§†é¢‘ä¸Šä¼ ",children:e.jsxs(I,{direction:"vertical",style:{width:"100%"},children:[o.urls&&o.urls.length>0&&e.jsxs("div",{style:{padding:"12px",background:"#f0f9ff",border:"1px solid #bae7ff",borderRadius:6,marginBottom:8},children:[e.jsx("div",{style:{fontSize:14,fontWeight:500,marginBottom:8,color:"#0958d9"},children:"ğŸ“¹ å·²æœ‰è§†é¢‘"}),o.urls.map((t,s)=>{const l=t.cdnUrl||t.ossUrl||t.originUrl||t.url||"";return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 0",borderTop:s>0?"1px solid #e6f4ff":"none"},children:[e.jsx("span",{style:{fontSize:12,fontWeight:500,color:"#0958d9",minWidth:50},children:t.quality}),e.jsx(P,{copyable:{text:l,tooltips:["å¤åˆ¶é“¾æ¥","å·²å¤åˆ¶"]},style:{margin:0,flex:1,fontSize:12,color:"#666"},ellipsis:{rows:1},children:l}),t.fileSize&&e.jsxs("span",{style:{fontSize:12,color:"#999",minWidth:60},children:[(t.fileSize/1024/1024).toFixed(1)," MB"]})]},s)})]}),e.jsxs(I,{children:[e.jsx(V,{value:$,onChange:We,style:{width:120},options:[{value:"360p",label:"360p"},{value:"480p",label:"480p"},{value:"720p",label:"720p"},{value:"1080p",label:"1080p"},{value:"1440p",label:"1440p"},{value:"2160p",label:"4K"}]}),e.jsx(at,{accept:"video/mp4,video/mpeg,video/quicktime,video/x-msvideo,video/webm",showUploadList:!1,customRequest:Ze,disabled:ae,children:e.jsx(S,{type:"primary",icon:e.jsx(ht,{}),loading:ae,children:"ä¸Šä¼ è§†é¢‘æ–‡ä»¶"})})]}),ae&&de>0&&e.jsx("div",{style:{width:"100%"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{flex:1,height:8,background:"#f0f0f0",borderRadius:4,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",background:"#52c41a",width:`${de}%`,transition:"width 0.3s ease"}})}),e.jsxs("span",{style:{fontSize:12,color:"#666",minWidth:40},children:[de,"%"]})]})}),e.jsx("div",{style:{fontSize:12,color:"#999",padding:"8px 12px",background:"#f5f5f5",borderRadius:4},children:"ğŸ’¡ æç¤ºï¼šæ”¯æŒä¸Šä¼  MP4ã€MOVã€AVIã€WebM ç­‰è§†é¢‘æ ¼å¼ï¼Œè§†é¢‘å°†ç›´æ¥ä¸Šä¼ åˆ° R2 å­˜å‚¨ï¼ˆä¸ç»è¿‡åç«¯æœåŠ¡å™¨ï¼‰"})]})}),!o&&e.jsx(T.Item,{label:"è§†é¢‘ä¸Šä¼ ",children:e.jsx("div",{style:{padding:"12px 16px",background:"#f6f8fa",borderRadius:6,border:"1px solid #e1e4e8"},children:e.jsx("div",{style:{fontSize:14,color:"#586069"},children:"ğŸ’¡ æç¤ºï¼šè¯·å…ˆåˆ›å»ºå‰§é›†ï¼Œåˆ›å»ºå®Œæˆåå¯åœ¨ç¼–è¾‘é¡µé¢ä¸Šä¼ è§†é¢‘æ–‡ä»¶"})})})]})]})}),e.jsx(G,{title:"ç¡®è®¤åˆ é™¤",open:Fe,onOk:Qe,onCancel:Ye,okText:"ç¡®è®¤åˆ é™¤",cancelText:"å–æ¶ˆ",okType:"danger",children:e.jsxs("p",{children:["ç¡®å®šè¦åˆ é™¤å‰§é›†ã€Œ",A?.title,"ã€å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚"]})}),e.jsx(G,{title:"ç¡®è®¤ä¿®æ”¹",open:Ae,onOk:Ge,onCancel:Xe,okText:"ç¡®è®¤ä¿®æ”¹",cancelText:"å–æ¶ˆ",children:e.jsxs("p",{children:["ç¡®å®šè¦ä¿®æ”¹å‰§é›†ã€Œ",q?.title,"ã€å—ï¼Ÿ"]})}),e.jsx(G,{title:"å‰§é›†ä¸‹è½½åœ°å€",open:He,onCancel:()=>H(!1),footer:[e.jsx(S,{onClick:()=>H(!1),children:"å…³é—­"},"close")],width:900,children:Ke?e.jsx("div",{style:{textAlign:"center",padding:"60px 0",fontSize:16,color:"#999"},children:"åŠ è½½ä¸­..."}):g?e.jsxs("div",{children:[e.jsx("div",{style:{background:"#f5f5f5",padding:"16px 20px",borderRadius:8,marginBottom:20},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 24px"},children:[e.jsxs("div",{children:[e.jsx(b,{type:"secondary",style:{fontSize:13},children:"ç³»åˆ—"}),e.jsxs("div",{style:{marginTop:4,fontSize:15},children:[g.seriesTitle," ",e.jsxs(b,{type:"secondary",children:["(#",g.seriesId,")"]})]})]}),e.jsxs("div",{children:[e.jsx(b,{type:"secondary",style:{fontSize:13},children:"é›†æ•°"}),e.jsxs("div",{style:{marginTop:4,fontSize:15},children:["ç¬¬ ",g.episodeNumber," é›†"]})]}),e.jsxs("div",{children:[e.jsx(b,{type:"secondary",style:{fontSize:13},children:"æ ‡é¢˜"}),e.jsx("div",{style:{marginTop:4,fontSize:15},children:g.episodeTitle})]}),e.jsxs("div",{children:[e.jsx(b,{type:"secondary",style:{fontSize:13},children:"æ—¶é•¿"}),e.jsxs("div",{style:{marginTop:4,fontSize:15},children:[Math.floor(g.duration/60)," åˆ† ",g.duration%60," ç§’"]})]})]})}),g.downloadUrls&&g.downloadUrls.length>0?e.jsx("div",{style:{maxHeight:500,overflowY:"auto",paddingRight:8},children:g.downloadUrls.map((t,s)=>e.jsxs("div",{style:{marginBottom:s<g.downloadUrls.length-1?24:0,paddingBottom:s<g.downloadUrls.length-1?24:0,borderBottom:s<g.downloadUrls.length-1?"1px solid #f0f0f0":"none"},children:[e.jsx("div",{style:{background:"#fafafa",padding:"8px 16px",borderRadius:6,marginBottom:12,display:"inline-block"},children:e.jsx(b,{strong:!0,style:{fontSize:16,color:"#1890ff"},children:t.quality})}),e.jsxs("div",{style:{paddingLeft:12},children:[t.cdnUrl&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("div",{style:{marginBottom:6},children:e.jsx(b,{strong:!0,style:{fontSize:14},children:"è§†é¢‘é“¾æ¥"})}),e.jsx(P,{copyable:{text:t.cdnUrl,onCopy:()=>f.success("å·²å¤åˆ¶è§†é¢‘é“¾æ¥")},ellipsis:{rows:2,expandable:!0},style:{marginBottom:8,padding:"8px 12px",background:"#fff",border:"1px solid #e8e8e8",borderRadius:4,fontSize:13,fontFamily:"Monaco, Menlo, monospace"},children:t.cdnUrl}),e.jsx(S,{type:"primary",icon:e.jsx(dt,{}),onClick:()=>Ie(t.cdnUrl,`${g.episodeTitle}_${t.quality}.mp4`),children:"ä¸‹è½½è§†é¢‘"})]}),t.subtitleUrl&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("div",{style:{marginBottom:6},children:e.jsx(b,{strong:!0,style:{fontSize:14},children:"å­—å¹•æ–‡ä»¶"})}),e.jsx(P,{copyable:{text:t.subtitleUrl,onCopy:()=>f.success("å·²å¤åˆ¶å­—å¹•åœ°å€")},ellipsis:{rows:2,expandable:!0},style:{marginBottom:8,padding:"8px 12px",background:"#fff",border:"1px solid #e8e8e8",borderRadius:4,fontSize:13,fontFamily:"Monaco, Menlo, monospace"},children:t.subtitleUrl}),e.jsx(S,{icon:e.jsx(ut,{}),onClick:()=>Ie(t.subtitleUrl,`${g.episodeTitle}_${t.quality}.srt`),children:"ä¸‹è½½å­—å¹•"})]}),(t.ossUrl||t.originUrl)&&e.jsxs("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px dashed #e8e8e8"},children:[e.jsx(b,{type:"secondary",style:{fontSize:12,marginBottom:8,display:"block"},children:"åŸå§‹åœ°å€"}),t.ossUrl&&e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(b,{type:"secondary",style:{fontSize:13},children:"OSS: "}),e.jsx(P,{copyable:{text:t.ossUrl,onCopy:()=>f.success("å·²å¤åˆ¶ OSS åœ°å€")},ellipsis:{rows:1,expandable:!0},style:{display:"inline",marginBottom:0,fontSize:12,fontFamily:"Monaco, Menlo, monospace"},children:t.ossUrl})]}),t.originUrl&&e.jsxs("div",{children:[e.jsx(b,{type:"secondary",style:{fontSize:13},children:"åŸå§‹: "}),e.jsx(P,{copyable:{text:t.originUrl,onCopy:()=>f.success("å·²å¤åˆ¶åŸå§‹åœ°å€")},ellipsis:{rows:1,expandable:!0},style:{display:"inline",marginBottom:0,fontSize:12,fontFamily:"Monaco, Menlo, monospace"},children:t.originUrl})]})]})]})]},t.id))}):e.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:e.jsx(b,{type:"secondary",children:"æš‚æ— å¯ç”¨çš„ä¸‹è½½åœ°å€"})})]}):e.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:e.jsx(b,{type:"secondary",children:"æ— æ³•åŠ è½½ä¸‹è½½ä¿¡æ¯"})})})]})}export{Ct as default};
