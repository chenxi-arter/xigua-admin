import{d as H,r,Q as X,A as N,p as u,q as l,a as i,y as t,s as a,F as B,v as y,D as k,T as O,z as g,U as Y,X as R,_ as F}from"./index-B7-n_d0o.js";import{a as G,S as P}from"./index-qkSD6ee2.js";import{P as T}from"./index-CzDlUzhK.js";import{L as K}from"./index-W1QOfryP.js";import{C as V}from"./index-BgmgAC7m.js";import{a as z,T as j}from"./index-DuGGXoww.js";import{N as q}from"./index-B3CRBCq2.js";import"./use-route-D56v4HMU.js";import"./use-id-CKbSJvxx.js";import"./use-placeholder-Cj0l6jok.js";const W={class:"flex h_100_vh flex_direction-column"},Z={class:"tabs flex_none"},$={class:"flex_auto overflow-hidden page_content"},ee={class:"load-box"},se={class:"scroll-box"},te={class:"left flex_none"},ae={class:"my-image"},oe={class:"van-image"},le=["src"],ne={class:"right flex_auto overflow-hidden"},re={key:0},ie={key:1},Ae=H({__name:"HistoryView",setup(de){const C=r(0),A=r(!1),v=r(!1),f=r(!1),p=r(!1);let m=1;const _=r([]),E=async(n=1,e=20)=>{try{const o=await Y.get("/api/video/browse-history",{params:{page:n,size:e}}),d=o.data.data.list.length??0;v.value=d===0||d<e,_.value.push(...o.data.data.list??[])}catch(o){console.error(o),f.value=!0,m--}},U=n=>{const e=Math.floor(n/3600),o=Math.floor(n%3600/60),d=n%60,b=e>0?String(e).padStart(2,"0")+":":"",h=String(o).padStart(2,"0"),w=String(d).padStart(2,"0");return b+h+":"+w},S=r("");X(async()=>{/iphone|ipod|android|blackberry|windows phone/i.test(navigator.userAgent.toLowerCase())?S.value="seriesPlay":S.value="play",A.value=!0,await E(),A.value=!1});const Q=async()=>{v.value=!1,m=1,_.value=[],p.value=!0,await E(),p.value=!1},x=async()=>{m++,A.value=!0,await E(m),A.value=!1},M=()=>{window.history.state?.back?R.back():R.push("/")};return(n,e)=>{const o=q,d=z,b=j,h=N("RouterLink"),w=V,D=K,I=T,J=G,L=P;return l(),u("div",W,[i(o,{title:"历史记录","left-arrow":"",class:"relative nav-bar",style:{color:"aliceblue"},onClickLeft:M},{left:a(()=>e[4]||(e[4]=[t("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAXNJREFUaEPt2TtKBEEYReFzMZMBd+ASXIGBmhgaGbkDlyGGJgYuQBAjAzP3YOoCRMHcRMTEkoYOOpgHXfU/ZrArmWD6cb6qoXqgxYYPbXg/EyB7BacV+LcrUEqZAXfAEXAl6aJmMlJ+Qn38E7DfR/8CM0nfYxHhgDnxXfOLpL2x8d3xoYAF8a/AoaS3tQZ4xIetgFd8CMAz3h3gHe8KiIh3AyyJP5D0XrPbLDrHfBuNjDdfgeh4U0BGvBkgK94EkBnfDMiObwKsQ3wr4BE4GezP3b9K831+1TOj+jlQSvkCtgc3OJX0sOqG1t+3AG6A80HQJ3As6dk6ctn1WgBbwC1wlomoBnTRpZR0RBNgHRDNgGyECSATYQbIQpgCMhDmgGiECyAS4QaIQrgCIhDuAG9ECMATEQbwQoQCliA+gF1J3YuOUSMcsADxA+xI6j5HjRTAAHHZvyO7lnQ/qrw/OA1QEzvvnAlgNZO115lWoHbmrM77A89a2jFh78iUAAAAAElFTkSuQmCC",alt:"",class:"left-arrow"},null,-1)])),right:a(()=>e[5]||(e[5]=[])),_:1}),t("div",Z,[i(b,{active:C.value,"onUpdate:active":e[0]||(e[0]=c=>C.value=c),"line-width":"0.3rem","line-height":"0.08rem",background:"transparent","title-active-color":"#e3e3e5"},{default:a(()=>[(l(),u(B,null,y(["剧集"],c=>i(d,{title:c,key:c},null,8,["title"])),64))]),_:1},8,["active"])]),t("div",$,[i(L,null,{default:a(()=>[(l(),u(B,null,y(["剧集"],c=>i(J,{key:c},{default:a(()=>[t("div",ee,[t("div",se,[i(I,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=s=>p.value=s),onRefresh:Q,"success-text":"刷新成功"},{default:a(()=>[i(D,{"immediate-check":!1,loading:A.value,"onUpdate:loading":e[1]||(e[1]=s=>A.value=s),finished:v.value,"finished-text":"没有更多了",onLoad:x,class:"series_list",error:f.value,"onUpdate:error":e[2]||(e[2]=s=>f.value=s),"error-text":"请求失败，点击重新加载"},{default:a(()=>[(l(!0),u(B,null,y(_.value,s=>(l(),k(w,{key:s.seriesShortId,style:{background:"#101012",padding:"0"},border:!1},{default:a(()=>[s.seriesShortId?(l(),k(h,{key:0,class:"flex",to:{name:S.value,params:{id:s.seriesShortId}}},{default:a(()=>[e[6]||(e[6]=t("div",{class:"select flex_none",style:{display:"none"}},[t("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAX9JREFUaEPtmb1KA0EUhb8JBEQDIsRSLazS7BsIi1aWVrGx9jX0BezzCFrYWgk+Qwq1sFBTmlLSBIwMEpzC2RnmZzeLd8vduXfPd87MLOwoWn6plutHAJpOUBKQBCIdqJ5CD4tjYATsRL4ntHwCnFOqO1sDF8B7g+KXmieUajcUYBFqXdK6UlmNdiUgAEmSkASS2BjRRBKIMC9JqSSQxMaIJpJAhHm20pM+DLfh7Bnmrs/lqiWgxV8PoNuB4SPcfDgcWiUAU/zFK1y+ecSbE6DYgKt9OH2C6bxaTJB43TInwH0Bh1sw/oSjsR0iWHxugH4XNETRs0NEic8NoPtXQUSLrwPABnGw+bvbeC/Yv5ZRzjVgvs9M4mUGe2s/W2WU+LoSWIKYEPpetPi6AczpdDv13Oddn4K6ppCpY70Dsy+XMs/nTQB4SvMbJgB+PuUbJQnk89avsyTg51O+Uf85gdb/Xm/5AUe+WZ2ss5xSJrMysJEkEGhcsjJJIJmVgY2+AQFptjFm78WRAAAAAElFTkSuQmCC",alt:"",style:{display:"none"}}),t("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAQ1JREFUaEPtmcENwkAMBG36gEagASrhGUfUgeI8qYQGoBHog0N55EfCaiMRnbR5e2/t2fPn4lb555X3bxpg7QSVgBJYSGD2CkWcj2bvaym2XehDyd3tZbY5ZV5uUwf8GKB9rtX82PAwRGa3owZomrYMQvdyyMwHhZEURcS+FL8P8r7vJkHPJjAOMHcA2R8kQ/w1AISSLFICCAESLiRD/LUDEEqySAkgBEi4kAzx1w5AKMkiJYAQIOFCMsRfOwChJIuUAEKAhAvJEH/tAISSLFICCAESLiRD/LUDEEqySAkgBEi4kAzx1w5AKMkiJVD9425E5c/r1f/gIHfvrzL9pfwr7i9mSkAJLCRQ/RX6AOwKGEBPows1AAAAAElFTkSuQmCC",alt:""})],-1)),t("div",te,[t("div",ae,[t("div",oe,[t("img",{class:"van-image__img",src:s.seriesCoverUrl,lazy:"loaded",style:{"object-fit":"fill"}},null,8,le)])])]),t("div",ne,[t("h2",null,g(s.seriesTitle),1),s.lastEpisodeNumber?(l(),u("p",re," 观看至"+g(s.lastEpisodeNumber<10?"0"+s.lastEpisodeNumber:s.lastEpisodeNumber)+"集 ",1)):(l(),u("p",ie,"未观看")),t("p",null,g(s.lastVisitTime),1),t("p",null," 播放进度"+g(U(s.durationSeconds)),1)])]),_:2,__:[6]},1032,["to"])):O("",!0)]),_:2},1024))),128))]),_:1},8,["loading","finished","error"])]),_:1},8,["modelValue"])])])]),_:2},1024)),64))]),_:1})])])}}}),be=F(Ae,[["__scopeId","data-v-fa8878b4"]]);export{be as default};
