import{I as x,j as e}from"./index-9W9txKnX.js";import{r as i}from"./react-vendor-BZ8KDC-J.js";import{G as Be,H as Ne,P as Le,F as d,u as Ke,b as de,d as E,I as f,R as b,C as p,f as L,v as ue,l as K,a as C,B as u,J as Ue,o as qe,s as o,m as z,r as T,x as B,K as We,g as he,N as me,i as He,j as Je,T as I,O as pe}from"./antd-vendor-aNvYRewR.js";import{A as N,d as M,e as Ge}from"./admin--tzWvWSE.js";import{R as fe}from"./EyeOutlined-DCfj9anr.js";import{R as U}from"./ReloadOutlined-Cgjr9nIU.js";import{R as Qe}from"./CopyOutlined-Bt83achq.js";import"./client-BbHh6MVO.js";import"./utils-vendor-NIGUFBhG.js";var Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm-600-80h56c4.4 0 8-3.6 8-8V560c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v144c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V384c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v320c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V462c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v242c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V304c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v400c0 4.4 3.6 8 8 8z"}}]},name:"bar-chart",theme:"outlined"};function H(){return H=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}return a},H.apply(this,arguments)}const Ze=(a,s)=>i.createElement(x,H({},a,{ref:s,icon:Xe})),xe=i.forwardRef(Ze);function J(){return J=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}return a},J.apply(this,arguments)}const et=(a,s)=>i.createElement(x,J({},a,{ref:s,icon:Be})),ge=i.forwardRef(et);function G(){return G=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}return a},G.apply(this,arguments)}const tt=(a,s)=>i.createElement(x,G({},a,{ref:s,icon:Ne})),je=i.forwardRef(tt);var rt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};function Q(){return Q=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}return a},Q.apply(this,arguments)}const st=(a,s)=>i.createElement(x,Q({},a,{ref:s,icon:rt})),at=i.forwardRef(st);var nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};function X(){return X=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}return a},X.apply(this,arguments)}const lt=(a,s)=>i.createElement(x,X({},a,{ref:s,icon:nt})),ot=i.forwardRef(lt);var it={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"};function Z(){return Z=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}return a},Z.apply(this,arguments)}const ct=(a,s)=>i.createElement(x,Z({},a,{ref:s,icon:it})),ye=i.forwardRef(ct);function ee(){return ee=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}return a},ee.apply(this,arguments)}const dt=(a,s)=>i.createElement(x,ee({},a,{ref:s,icon:Le})),q=i.forwardRef(dt);var ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"};function te(){return te=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}return a},te.apply(this,arguments)}const ht=(a,s)=>i.createElement(x,te({},a,{ref:s,icon:ut})),mt=i.forwardRef(ht),{Search:pt}=f,{Option:W}=L,{Text:P}=He,ve=[{label:"草稿",value:"draft",color:"default"},{label:"投放中",value:"active",color:"success"},{label:"已暂停",value:"paused",color:"warning"},{label:"已完成",value:"completed",color:"processing"},{label:"已取消",value:"cancelled",color:"error"}],Ot=()=>{const[a,s]=i.useState([]),[n,l]=i.useState([]),[w,re]=i.useState(null),[se,ae]=i.useState(!1),[ne,le]=i.useState(null),[be,oe]=i.useState(!1),[Ce,O]=i.useState(!1),[Y,S]=i.useState(null),[g]=d.useForm(),[we,Oe]=i.useState("campaigns"),[Se,$]=i.useState(!1),[A,k]=i.useState(null),[R]=d.useForm(),[ie]=i.useState(!1),[m,F]=i.useState({keyword:"",platform:"",status:"",dateRange:null}),[j,V]=i.useState({current:1,pageSize:20,total:0}),_=async()=>{try{const t=await N.list({enabled:!0});l(t.data||[])}catch(t){console.error("加载平台列表失败:",t),(t.code==="ECONNREFUSED"||t.response?.status===404)&&l([{id:1,name:"抖音",code:"tiktok",color:"#ff0050",isEnabled:!0,sortOrder:1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:2,name:"微信",code:"wechat",color:"#07c160",isEnabled:!0,sortOrder:2,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:3,name:"百度",code:"baidu",color:"#2932e1",isEnabled:!0,sortOrder:3,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}])}},y=async()=>{ae(!0),le(null);try{const t={keyword:m.keyword||void 0,platform:m.platform||void 0,status:m.status||void 0};m.dateRange&&(t.startDate=m.dateRange[0].format("YYYY-MM-DD"),t.endDate=m.dateRange[1].format("YYYY-MM-DD"));const r=await M.list(j.current,j.pageSize,t),c=(r.data?.items||[]).map(h=>{const v=n.find(_e=>_e.code===h.platform);return{...h,platformCode:h.platform,platformId:v?.id||0}});s(c),V(h=>({...h,total:r.data?.total||0}))}catch(t){console.error("加载投放计划失败:",t);let r="";t.code==="ECONNABORTED"||t.message?.includes("timeout")?(r="请求超时，数据加载时间过长",o.error({content:r+"。请检查网络连接或稍后重试",duration:5})):t.code==="ERR_NETWORK"?(r="网络连接失败",o.error({content:r+"，请检查后端服务是否正常运行",duration:5})):t.response?.status===404?(r="投放计划API接口不存在",o.error(r)):t.response?.status>=500?(r="服务器错误",o.error(r+"，请稍后重试")):(r=t.message||"加载失败",o.error(`加载失败: ${r}`)),le(r),s([]),V(c=>({...c,total:0}))}finally{ae(!1)}},D=async()=>{oe(!0);try{const t={};m.dateRange&&(t.from=m.dateRange[0].format("YYYY-MM-DD"),t.to=m.dateRange[1].format("YYYY-MM-DD"));const r=await Ge.overview(t);re(r)}catch(t){console.error("加载仪表盘数据失败:",t),re({totalCampaigns:0,activeCampaigns:0,totalSpend:0,totalClicks:0,totalConversions:0,avgConversionRate:0,platformStats:[],recentEvents:[]}),t.code==="ECONNABORTED"||t.message?.includes("timeout")?o.warning({content:"仪表盘数据加载超时，显示默认数据",duration:3}):t.code!=="ERR_NETWORK"&&o.warning("仪表盘数据加载失败，显示默认数据")}finally{oe(!1)}};i.useEffect(()=>{_()},[]),i.useEffect(()=>{n.length>0&&(y(),D())},[j.current,j.pageSize,m,n]);const Re=async t=>{try{const r=n.find(h=>h.id===t.platformId);if(!r){o.error("请选择有效的投放平台");return}const c={name:t.name,description:t.description,platform:r.code,targetUrl:t.targetUrl,startDate:t.startDate.format("YYYY-MM-DD"),endDate:t.endDate?.format("YYYY-MM-DD")};Y?(await M.update(Y.id,c),o.success("投放计划更新成功")):(await M.create(c),o.success("投放计划创建成功")),O(!1),S(null),g.resetFields(),y(),D()}catch(r){console.error("保存投放计划失败:",r),r.response?.data?.message?o.error(`保存失败: ${r.response.data.message}`):r.code==="ERR_NETWORK"?o.error("网络连接失败，请检查后端服务"):o.error("保存投放计划失败，请稍后重试")}},De=async t=>{try{await M.remove(t),o.success("投放计划删除成功"),y(),D()}catch(r){console.error("删除投放计划失败:",r),o.error("删除投放计划失败")}},ce=async(t,r)=>{try{await M.updateStatus(t,r),o.success("状态更新成功"),y(),D()}catch(c){console.error("状态更新失败:",c),o.error("状态更新失败")}},Ee=t=>{const r=t.platformCode||t.platform||"unknown",c=t.campaignCode||`${r}_${t.id}`,h=`${t.targetUrl}?utm_campaign=${c}&utm_source=${r}`;navigator.clipboard.writeText(h).then(()=>{o.success("投放链接已复制到剪贴板")}).catch(()=>{o.error("复制失败")})},Ie=t=>{try{S(t);const r=t.startDate?E(t.startDate):null,c=t.endDate?E(t.endDate):null;g.setFieldsValue({name:t.name,description:t.description,platformId:t.platformId,targetUrl:t.targetUrl,startDate:r||void 0,endDate:c||void 0}),O(!0)}catch(r){console.error("编辑表单设置失败:",r),o.error(`打开编辑表单失败: ${r instanceof Error?r.message:"未知错误"}`)}},Pe=()=>{k(null),R.resetFields(),$(!0)},$e=t=>{k(t),R.setFieldsValue({name:t.name,code:t.code,description:t.description,color:t.color,isEnabled:t.isEnabled,sortOrder:t.sortOrder}),$(!0)},ke=async t=>{try{await N.remove(t),o.success("平台删除成功"),_()}catch(r){console.error("删除平台失败:",r),r.response?.status===409?o.error("无法删除该平台：该平台正在被投放计划使用，请先删除相关的投放计划"):r.response?.data?.message?o.error(`删除失败: ${r.response.data.message}`):r.code==="ERR_NETWORK"?o.error("网络连接失败，请检查后端服务"):o.error(`删除平台失败: ${r.message}`)}},ze=async t=>{try{const r={name:t.name,code:t.code,description:t.description,color:typeof t.color=="string"?t.color:t.color?.toHexString?.()||"#1890ff",isEnabled:t.isEnabled??!0,sortOrder:t.sortOrder||0};A?(await N.update(A.id,r),o.success("平台更新成功")):(await N.create(r),o.success("平台创建成功")),$(!1),k(null),R.resetFields(),_()}catch(r){if(console.error("保存平台失败:",r),r.response?.data?.message)o.error(`保存失败: ${r.response.data.message}`);else if(r.response?.data?.details){const c=r.response.data.details;if(Array.isArray(c)){const h=c.map(v=>v.constraints?Object.values(v.constraints).join(", "):v).join("; ");o.error(`验证失败: ${h}`)}else o.error(`保存失败: ${JSON.stringify(c)}`)}else r.code==="ERR_NETWORK"?o.error("网络连接失败，请检查后端服务"):o.error(`保存平台失败: ${r.message}`)}},Te=t=>n.find(c=>c.code===t)?.color||"#8c8c8c",Me=t=>{const r=ve.find(c=>c.value===t);return e.jsx(B,{color:r?.color,children:r?.label})},Ye=[{title:"平台名称",dataIndex:"name",key:"name",width:150,render:(t,r)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{width:16,height:16,backgroundColor:r.color,borderRadius:4}}),e.jsx("span",{style:{fontWeight:500},children:t})]})},{title:"平台代码",dataIndex:"code",key:"code",width:120},{title:"描述",dataIndex:"description",key:"description",width:200,render:t=>t||"-"},{title:"状态",dataIndex:"isEnabled",key:"isEnabled",width:100,render:t=>e.jsx(B,{color:t?"success":"default",children:t?"启用":"禁用"})},{title:"排序",dataIndex:"sortOrder",key:"sortOrder",width:80,render:t=>t||0},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:150,render:t=>E(t).format("YYYY-MM-DD HH:mm")},{title:"操作",key:"actions",width:150,render:t=>e.jsxs(C,{size:"small",children:[e.jsx(u,{type:"text",icon:e.jsx(je,{}),onClick:()=>$e(t)}),e.jsx(pe,{title:"确定要删除这个平台吗？",description:"注意：如果该平台正在被投放计划使用，将无法删除。请先删除相关的投放计划。",onConfirm:()=>ke(t.id),okText:"确定删除",cancelText:"取消",okButtonProps:{danger:!0},children:e.jsx(u,{type:"text",danger:!0,icon:e.jsx(ge,{})})})]})}],Ae=[{title:"计划名称",dataIndex:"name",key:"name",width:200,render:(t,r)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:t}),e.jsx(P,{type:"secondary",style:{fontSize:12},children:r.campaignCode})]})},{title:"投放平台",key:"platform",width:100,render:t=>{const r=t.platformCode||t.platform||"",c=n.find(h=>h.code===r);return e.jsx(B,{color:Te(r),children:c?.name||r||"未知平台"})}},{title:"状态",key:"status",width:100,render:t=>{const r=t.isActive?"active":"paused";return Me(r)}},{title:"投放时间",key:"dateRange",width:180,render:t=>e.jsxs("div",{children:[e.jsx("div",{children:E(t.startDate).format("YYYY-MM-DD")}),t.endDate&&e.jsxs(P,{type:"secondary",style:{fontSize:12},children:["至 ",E(t.endDate).format("YYYY-MM-DD")]})]})},{title:"效果数据",key:"stats",width:200,render:t=>{const r=t.stats;if(!r)return"-";const c=r.totalClicks||0,h=r.totalConversions||0,v=c>0?h/c:0;return e.jsxs("div",{children:[e.jsx("div",{children:e.jsxs(P,{strong:!0,children:["点击: ",c.toLocaleString()]})}),e.jsxs("div",{children:[e.jsxs(P,{type:"secondary",style:{fontSize:12},children:["转化: ",h.toLocaleString()]}),e.jsx(Je,{type:"vertical"}),e.jsxs(P,{type:"secondary",style:{fontSize:12},children:["转化率: ",(v*100).toFixed(2),"%"]})]})]})}},{title:"操作",key:"actions",width:200,render:t=>e.jsxs(C,{size:"small",children:[e.jsx(I,{title:"查看详情",children:e.jsx(u,{type:"text",icon:e.jsx(fe,{}),onClick:()=>{}})}),e.jsx(I,{title:"编辑",children:e.jsx(u,{type:"text",icon:e.jsx(je,{}),onClick:()=>Ie(t)})}),e.jsx(I,{title:"复制投放链接",children:e.jsx(u,{type:"text",icon:e.jsx(Qe,{}),onClick:()=>Ee(t)})}),t.isActive?e.jsx(I,{title:"暂停",children:e.jsx(u,{type:"text",icon:e.jsx(ot,{}),onClick:()=>ce(t.id,"paused")})}):e.jsx(I,{title:"启用",children:e.jsx(u,{type:"text",icon:e.jsx(ye,{}),onClick:()=>ce(t.id,"active")})}),e.jsx(pe,{title:"确定要删除这个投放计划吗？",onConfirm:()=>De(t.id),okText:"确定",cancelText:"取消",children:e.jsx(I,{title:"删除",children:e.jsx(u,{type:"text",danger:!0,icon:e.jsx(ge,{})})})})]})}],Fe=()=>e.jsxs("div",{children:[e.jsxs(z,{style:{marginBottom:24},loading:be,children:[e.jsxs(b,{gutter:16,children:[e.jsx(p,{span:6,children:e.jsx(T,{title:"总投放计划",value:w?.totalCampaigns||0,prefix:e.jsx(xe,{})})}),e.jsx(p,{span:6,children:e.jsx(T,{title:"活跃计划",value:w?.activeCampaigns||0,valueStyle:{color:"#3f8600"},prefix:e.jsx(ye,{})})}),e.jsx(p,{span:6,children:e.jsx(T,{title:"总点击量",value:w?.totalClicks||0,prefix:e.jsx(fe,{})})}),e.jsx(p,{span:6,children:e.jsx(T,{title:"总转化量",value:w?.totalConversions||0,valueStyle:{color:"#cf1322"}})})]}),w?.avgConversionRate!==void 0&&e.jsx(b,{gutter:16,style:{marginTop:16},children:e.jsx(p,{span:6,children:e.jsx(T,{title:"平均转化率",value:(w.avgConversionRate*100).toFixed(2),suffix:"%",precision:2})})})]}),e.jsx(z,{style:{marginBottom:24},children:e.jsxs(b,{gutter:16,align:"middle",children:[e.jsx(p,{flex:"auto",children:e.jsxs(C,{size:"middle",children:[e.jsx(pt,{placeholder:"搜索计划名称或代码",style:{width:250},value:m.keyword,onChange:t=>F(r=>({...r,keyword:t.target.value})),onSearch:()=>{V(t=>({...t,current:1})),y()}}),e.jsx(L,{placeholder:"选择平台",style:{width:120},allowClear:!0,value:m.platform||void 0,onChange:t=>F(r=>({...r,platform:t||""})),children:n.map(t=>e.jsx(W,{value:t.code,children:e.jsx(ue,{color:t.color,text:t.name})},t.code))}),e.jsx(L,{placeholder:"选择状态",style:{width:120},allowClear:!0,value:m.status||void 0,onChange:t=>F(r=>({...r,status:t||""})),children:ve.map(t=>e.jsx(W,{value:t.value,children:e.jsx(B,{color:t.color,children:t.label})},t.value))}),e.jsx(K.RangePicker,{value:m.dateRange,onChange:t=>F(r=>({...r,dateRange:t})),placeholder:["开始日期","结束日期"]})]})}),e.jsx(p,{children:e.jsxs(C,{children:[e.jsx(u,{icon:e.jsx(U,{}),onClick:()=>{y(),D()},children:"刷新"}),e.jsx(u,{type:"primary",icon:e.jsx(q,{}),onClick:()=>{S(null),g.resetFields(),O(!0)},children:"新建投放计划"})]})})]})}),e.jsx(z,{children:ne&&!se?e.jsx(We,{status:"error",icon:e.jsx(at,{}),title:"数据加载失败",subTitle:ne,extra:e.jsx(u,{type:"primary",icon:e.jsx(U,{}),onClick:()=>{y(),D()},children:"重新加载"})}):e.jsx(he,{columns:Ae,dataSource:a,rowKey:"id",loading:se,locale:{emptyText:e.jsx(me,{description:"暂无投放计划数据",image:me.PRESENTED_IMAGE_SIMPLE,children:e.jsx(u,{type:"primary",icon:e.jsx(q,{}),onClick:()=>{S(null),g.resetFields(),O(!0)},children:"创建第一个投放计划"})})},pagination:{current:j.current,pageSize:j.pageSize,total:j.total,showSizeChanger:!0,showQuickJumper:!0,showTotal:t=>`共 ${t} 条记录`,onChange:(t,r)=>{V(c=>({...c,current:t,pageSize:r||20}))}},scroll:{x:1200}})})]}),Ve=()=>e.jsxs("div",{children:[e.jsx(z,{style:{marginBottom:24},children:e.jsxs(b,{gutter:16,align:"middle",children:[e.jsx(p,{flex:"auto",children:e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0},children:"平台管理"}),e.jsx(P,{type:"secondary",children:"管理广告投放平台，设置平台信息和显示样式"})]})}),e.jsx(p,{children:e.jsxs(C,{children:[e.jsx(u,{icon:e.jsx(U,{}),onClick:_,loading:ie,children:"刷新"}),e.jsx(u,{type:"primary",icon:e.jsx(q,{}),onClick:Pe,children:"新建平台"})]})})]})}),e.jsx(z,{children:e.jsx(he,{columns:Ye,dataSource:n,rowKey:"id",loading:ie,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:t=>`共 ${t} 个平台`}})})]});return e.jsxs("div",{children:[e.jsx(Ke,{activeKey:we,onChange:Oe,items:[{key:"campaigns",label:e.jsxs("span",{children:[e.jsx(xe,{}),"投放计划"]}),children:Fe()},{key:"platforms",label:e.jsxs("span",{children:[e.jsx(mt,{}),"平台管理"]}),children:Ve()}]}),e.jsx(de,{title:Y?"编辑投放计划":"新建投放计划",open:Ce,onCancel:()=>{try{O(!1),S(null),g.resetFields()}catch(t){console.error("关闭模态框失败:",t)}},footer:null,width:600,destroyOnClose:!0,children:e.jsxs(d,{form:g,layout:"vertical",onFinish:Re,initialValues:{startDate:E()},children:[e.jsx(d.Item,{name:"name",label:"计划名称",rules:[{required:!0,message:"请输入计划名称"}],children:e.jsx(f,{placeholder:"请输入计划名称"})}),e.jsx(d.Item,{name:"description",label:"计划描述",children:e.jsx(f.TextArea,{placeholder:"请输入计划描述",rows:3})}),e.jsx(b,{gutter:16,children:e.jsx(p,{span:12,children:e.jsx(d.Item,{name:"platformId",label:"投放平台",rules:[{required:!0,message:"请选择投放平台"}],children:e.jsx(L,{placeholder:"请选择投放平台",children:n.map(t=>e.jsx(W,{value:t.id,children:e.jsx(ue,{color:t.color,text:t.name})},t.id))})})})}),e.jsx(d.Item,{name:"targetUrl",label:"目标链接",rules:[{required:!0,message:"请输入目标链接"},{type:"url",message:"请输入有效的URL"}],children:e.jsx(f,{placeholder:"https://m.xgshort.com/"})}),e.jsxs(b,{gutter:16,children:[e.jsx(p,{span:12,children:e.jsx(d.Item,{name:"startDate",label:"开始时间",rules:[{required:!0,message:"请选择开始时间"}],children:e.jsx(K,{style:{width:"100%"}})})}),e.jsx(p,{span:12,children:e.jsx(d.Item,{name:"endDate",label:"结束时间",children:e.jsx(K,{style:{width:"100%"}})})})]}),e.jsx(d.Item,{style:{marginBottom:0,textAlign:"right"},children:e.jsxs(C,{children:[e.jsx(u,{onClick:()=>{O(!1),S(null),g.resetFields()},children:"取消"}),e.jsx(u,{type:"primary",htmlType:"submit",children:Y?"更新":"创建"})]})})]})}),e.jsx(de,{title:A?"编辑平台":"新建平台",open:Se,onCancel:()=>{$(!1),k(null),R.resetFields()},footer:null,width:600,children:e.jsxs(d,{form:R,layout:"vertical",onFinish:ze,children:[e.jsx(d.Item,{name:"name",label:"平台名称",rules:[{required:!0,message:"请输入平台名称"}],children:e.jsx(f,{placeholder:"请输入平台名称"})}),e.jsx(d.Item,{name:"code",label:"平台代码",rules:[{required:!0,message:"请输入平台代码"}],children:e.jsx(f,{placeholder:"请输入平台代码"})}),e.jsx(d.Item,{name:"description",label:"平台描述",children:e.jsx(f.TextArea,{placeholder:"请输入平台描述",rows:3})}),e.jsx(d.Item,{name:"color",label:"平台颜色",initialValue:"#1890ff",rules:[{required:!0,message:"请选择平台颜色"},{pattern:/^#[0-9A-Fa-f]{6}$/,message:"请输入有效的颜色值，如 #1890ff"}],children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(Ue,{presets:[{label:"推荐颜色",colors:["#ff0050","#07c160","#2932e1","#4285f4","#e6162d","#ff6900","#1890ff","#52c41a","#faad14","#f5222d","#722ed1","#13c2c2"]}]}),e.jsx(f,{placeholder:"请输入颜色值，如 #1890ff",maxLength:7})]})}),e.jsxs(b,{gutter:16,children:[e.jsx(p,{span:12,children:e.jsx(d.Item,{name:"sortOrder",label:"排序",initialValue:0,children:e.jsx(f,{type:"number",placeholder:"排序值，数字越小越靠前"})})}),e.jsx(p,{span:12,children:e.jsx(d.Item,{name:"isEnabled",label:"启用状态",valuePropName:"checked",initialValue:!0,children:e.jsx(qe,{checkedChildren:"启用",unCheckedChildren:"禁用"})})})]}),e.jsx(d.Item,{style:{marginBottom:0,textAlign:"right"},children:e.jsxs(C,{children:[e.jsx(u,{onClick:()=>{$(!1),k(null),R.resetFields()},children:"取消"}),e.jsx(u,{type:"primary",htmlType:"submit",children:A?"更新":"创建"})]})})]})})]})};export{Ot as default};
