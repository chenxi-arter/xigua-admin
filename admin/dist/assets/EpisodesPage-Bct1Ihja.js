import{I as Re,j as e}from"./index-dZ-ab8fY.js";import{r as i,k as et}from"./react-vendor-BZ8KDC-J.js";import{E as k,S as tt,a as Ie}from"./admin-DxX4aGPR.js";import{f as W}from"./format-0Cj3JWJt.js";import{q as st,F as C,s as h,T as it,a as I,B as b,f as B,p as _,g as nt,b as Q,i as c,j as ze,I as ot,U as lt}from"./antd-vendor-BWliGsmx.js";import{R as Ue}from"./CopyOutlined-Dil6vWtD.js";import{R as rt}from"./DownloadOutlined-CO20BKGR.js";import"./client-yVgCOTGo.js";import"./utils-vendor-NIGUFBhG.js";function ae(){return ae=Object.assign?Object.assign.bind():function(y){for(var f=1;f<arguments.length;f++){var j=arguments[f];for(var g in j)Object.prototype.hasOwnProperty.call(j,g)&&(y[g]=j[g])}return y},ae.apply(this,arguments)}const at=(y,f)=>i.createElement(Re,ae({},y,{ref:f,icon:st})),dt=i.forwardRef(at);var ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};function de(){return de=Object.assign?Object.assign.bind():function(y){for(var f=1;f<arguments.length;f++){var j=arguments[f];for(var g in j)Object.prototype.hasOwnProperty.call(j,g)&&(y[g]=j[g])}return y},de.apply(this,arguments)}const ut=(y,f)=>i.createElement(Re,de({},y,{ref:f,icon:ct})),pt=i.forwardRef(ut),{Paragraph:P,Text:w}=c,ht=y=>{const f=Math.floor(y/3600),j=Math.floor(y%3600/60),g=y%60;return f>0?`${f}æ—¶${j}åˆ†${g}ç§’`:j>0?`${j}åˆ†${g}ç§’`:`${g}ç§’`};function St(){const[y]=et(),f=Number(y.get("seriesId")||"")||void 0,[j,g]=i.useState(!1),[Ee,Me]=i.useState([]),[Oe,$e]=i.useState(0),[Y,De]=i.useState(1),[G,Be]=i.useState(10),ce=i.useRef(1),X=i.useRef(10);i.useEffect(()=>{ce.current=Y},[Y]),i.useEffect(()=>{X.current=G},[G]);const[Le,E]=i.useState(!1),[o,V]=i.useState(null),[S]=C.useForm(),[Pe,Z]=i.useState(!1),[A,J]=i.useState(null),[Ve,ee]=i.useState(!1),[F,te]=i.useState(null),[z,Ae]=i.useState(f),[U,se]=i.useState([]),ue=i.useRef([]);i.useEffect(()=>{ue.current=U},[U]);const[M,pe]=i.useState(!1),[he,fe]=i.useState(1),[xe,ye]=i.useState(!0),O=i.useRef(void 0),ie=i.useRef(""),ne=i.useRef(1),[Fe,q]=i.useState(!1),[m,qe]=i.useState(null),[He,me]=i.useState(!1),[H,ge]=i.useState(void 0),[N,je]=i.useState(void 0),[oe,ve]=i.useState(!1),[le,re]=i.useState(0),[$,Ne]=i.useState("720p"),Ke=async t=>{const s=Array.from(new Set(t.filter(n=>typeof n=="number")));if(s.length===0)return;const l=new Set(ue.current.map(n=>n.value)),r=s.filter(n=>!l.has(n));if(r.length!==0)try{const n=await Promise.all(r.map(async a=>{try{const u=await Ie.get(a),d=`#${a}${u?.title?` ${u.title}`:""}`;return{value:a,label:d}}catch{return{value:a,label:`#${a}`}}}));n.length>0&&se(a=>Array.from(new Map([...a,...n].map(u=>[u.value,u])).values()))}catch{}},T=i.useCallback(async(t,s)=>{const l=t??ce.current,r=s??X.current;g(!0);try{const n={};z&&(n.seriesId=z),H!==void 0&&(n.minDuration=H),N!==void 0&&(n.maxDuration=N);const a=await k.list(l,r,n),u=(a.items||[]).slice().sort((d,v)=>d.seriesId!==v.seriesId?d.seriesId-v.seriesId:d.episodeNumber-v.episodeNumber);Me(u),$e(a.total),De(a.page),Be(a.size),Ke(u.map(d=>d.seriesId))}finally{g(!1)}},[z,H,N]);i.useEffect(()=>{T(1,X.current)},[T]);const K=50,R=i.useCallback(async t=>{const s=t?.keyword!==void 0?t.keyword:ie.current,l=t?.reset?1:t?.page||ne.current;pe(!0);try{if(s&&s.trim()){const n=await tt.fuzzy({keyword:s.trim(),page:l,size:K}),a=n?.data||n,d=(a?.list||a?.items||[]).map(L=>({value:L.id,label:`#${L.id} ${L.title||""}`}));se(L=>t?.reset?d:Array.from(new Map([...L,...d].map(ke=>[ke.value,ke])).values()));const v=a?.page||l;fe(v),ne.current=v;const p=a?.total??0,x=a?.size??K;ye(v*x<p||a?.hasMore===!0)}else{const n=await Ie.list(l,K),a=(n.items||[]).map(x=>({value:x.id,label:`#${x.id} ${x.title||""}`}));se(x=>t?.reset?a:Array.from(new Map([...x,...a].map(D=>[D.value,D])).values()));const u=n.page||l;fe(u),ne.current=u;const d=n.total??0,v=n.size??K;ye(u*v<d)}const r=t?.keyword!==void 0?t.keyword:ie.current;ie.current=r||""}catch{}finally{pe(!1)}},[]);i.useEffect(()=>{R({reset:!0})},[R]);const we=i.useCallback(async t=>{try{const s=await k.get(t.id);V(s),S.setFieldsValue(s),E(!0)}catch(s){console.error("è·å–å‰§é›†è¯¦æƒ…å¤±è´¥:",s),V(t),S.setFieldsValue(t),E(!0)}},[S]),be=i.useCallback(t=>{J(t),Z(!0)},[]),We=i.useCallback(async()=>{if(A)try{await k.remove(A.id),h.success("å·²åˆ é™¤"),T()}catch{h.error("åˆ é™¤å¤±è´¥")}finally{Z(!1),J(null)}},[A,T]),_e=i.useCallback(()=>{Z(!1),J(null)},[]),Qe=i.useCallback(async()=>{if(!(!o||!F))try{await k.update(o.id,F),h.success("å·²æ›´æ–°"),E(!1),T()}catch{h.error("ä¿®æ”¹å¤±è´¥")}finally{ee(!1),te(null)}},[o,F,T]),Ye=i.useCallback(()=>{ee(!1),te(null)},[]),Se=i.useCallback(async t=>{me(!0),q(!0);try{const s=await k.getDownloadUrls(t.id);qe(s)}catch{h.error("è·å–ä¸‹è½½åœ°å€å¤±è´¥"),q(!1)}finally{me(!1)}},[]),Ce=i.useCallback((t,s)=>{const l=document.createElement("a");l.href=t,l.download=s,l.target="_blank",document.body.appendChild(l),l.click(),document.body.removeChild(l)},[]),Te=i.useCallback(t=>new Promise((s,l)=>{const r=document.createElement("video");r.preload="metadata",r.onloadedmetadata=()=>{window.URL.revokeObjectURL(r.src);const n=Math.round(r.duration),a=r.videoHeight>r.videoWidth;console.log("[è§†é¢‘å…ƒæ•°æ®]",{duration:n+"ç§’",width:r.videoWidth,height:r.videoHeight,isVertical:a?"ç«–å±":"æ¨ªå±"}),s({duration:n,isVertical:a})},r.onerror=()=>{window.URL.revokeObjectURL(r.src),l(new Error("æ— æ³•è¯»å–è§†é¢‘å…ƒæ•°æ®"))},r.src=window.URL.createObjectURL(t)}),[]),Ge=i.useCallback(async t=>{const{file:s,onSuccess:l,onError:r}=t;if(!o){h.warning("è¯·å…ˆåˆ›å»ºå‰§é›†ï¼Œåˆ›å»ºå®Œæˆåå¯åœ¨ç¼–è¾‘é¡µé¢ä¸Šä¼ è§†é¢‘"),r?.(new Error("æ–°å»ºæ¨¡å¼ä¸æ”¯æŒæ–‡ä»¶ä¸Šä¼ "));return}try{ve(!0),re(0);const n=s;try{const d=await Te(n);S.setFieldsValue({duration:d.duration,isVertical:d.isVertical}),h.success(`å·²è‡ªåŠ¨è¯†åˆ«ï¼šæ—¶é•¿${d.duration}ç§’ï¼Œ${d.isVertical?"ç«–å±":"æ¨ªå±"}`)}catch(d){console.warn("[è§†é¢‘å…ƒæ•°æ®] æå–å¤±è´¥:",d),h.warning("æ— æ³•è‡ªåŠ¨è¯†åˆ«è§†é¢‘ä¿¡æ¯ï¼Œè¯·æ‰‹åŠ¨å¡«å†™")}if(!["video/mp4","video/mpeg","video/quicktime","video/x-msvideo","video/webm"].includes(n.type))throw new Error("ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹ï¼Œè¯·ä¸Šä¼  MP4ã€MOVã€AVI æˆ– WebM è§†é¢‘");console.log("[è§†é¢‘ä¸Šä¼ ] å¼€å§‹è·å–é¢„ç­¾å URL",{episodeId:o.id,filename:n.name,contentType:n.type,quality:$,fileSize:n.size});const u=await k.getPresignedUploadUrl(o.id,{filename:n.name,contentType:n.type||"video/mp4",quality:$});console.log("[è§†é¢‘ä¸Šä¼ ] è·å–é¢„ç­¾å URL æˆåŠŸ",u),await new Promise((d,v)=>{const p=new XMLHttpRequest;p.upload.addEventListener("progress",x=>{if(x.lengthComputable){const D=Math.round(x.loaded/x.total*100);re(D),console.log("[è§†é¢‘ä¸Šä¼ ] è¿›åº¦:",D+"%")}}),p.addEventListener("load",()=>{if(console.log("[è§†é¢‘ä¸Šä¼ ] è¯·æ±‚å®Œæˆ",{status:p.status,statusText:p.statusText,responseText:p.responseText}),p.status===200||p.status===204)console.log("[è§†é¢‘ä¸Šä¼ ] ä¸Šä¼ åˆ° R2 æˆåŠŸ"),d();else{const x=`ä¸Šä¼ å¤±è´¥ (çŠ¶æ€ç : ${p.status})${p.responseText?": "+p.responseText:""}`;console.error("[è§†é¢‘ä¸Šä¼ ] å¤±è´¥:",x),v(new Error(x))}}),p.addEventListener("error",x=>{console.error("[è§†é¢‘ä¸Šä¼ ] ç½‘ç»œé”™è¯¯:",x),console.error("[è§†é¢‘ä¸Šä¼ ] å¯èƒ½çš„åŸå› : CORS é…ç½®é—®é¢˜ã€ç½‘ç»œä¸­æ–­ã€æˆ– R2 è®¿é—®æƒé™é—®é¢˜"),v(new Error("ä¸Šä¼ å¤±è´¥ï¼šç½‘ç»œé”™è¯¯æˆ– CORS é…ç½®é—®é¢˜"))}),p.addEventListener("abort",()=>{console.warn("[è§†é¢‘ä¸Šä¼ ] ä¸Šä¼ å·²å–æ¶ˆ"),v(new Error("ä¸Šä¼ å·²å–æ¶ˆ"))}),console.log("[è§†é¢‘ä¸Šä¼ ] å¼€å§‹ä¸Šä¼ åˆ° R2",{url:u.uploadUrl.substring(0,100)+"...",contentType:n.type||"video/mp4"}),p.open("PUT",u.uploadUrl),p.setRequestHeader("Content-Type",n.type||"video/mp4"),p.send(n)}),await k.notifyUploadComplete(o.id,{fileKey:u.fileKey,publicUrl:u.publicUrl,quality:$,fileSize:n.size});try{const d=await k.get(o.id);V(d),d.duration&&S.setFieldsValue({duration:d.duration})}catch{}h.success(`è§†é¢‘ä¸Šä¼ æˆåŠŸ (${$})`),l?.({})}catch(n){r?.(n instanceof Error?n:new Error(String(n))),h.error(`è§†é¢‘ä¸Šä¼ å¤±è´¥: ${n instanceof Error?n.message:String(n)}`)}finally{ve(!1),re(0)}},[o,$,T,Te,S]),Xe=i.useMemo(()=>[{title:"ID",dataIndex:"id",width:80},{title:"ç³»åˆ—",dataIndex:"seriesTitle",width:220,render:(t,s)=>s.seriesTitle||(()=>{const l=U.find(r=>r.value===s.seriesId);return l?l.label:`#${s.seriesId}`})()},{title:"é›†æ•°",dataIndex:"episodeNumber",width:80},{title:"æ ‡é¢˜",dataIndex:"title",width:200,ellipsis:{showTitle:!1},render:t=>e.jsx(it,{placement:"topLeft",title:t,children:e.jsx("span",{children:t})})},{title:"æ—¶é•¿",dataIndex:"duration",width:110,render:t=>e.jsx("span",{title:`${t}ç§’`,children:ht(t)})},{title:"çŠ¶æ€",dataIndex:"status",width:100,render:t=>t==="published"?"å·²å‘å¸ƒ":t==="hidden"?"éšè—":t==="draft"?"è‰ç¨¿":t||"-"},{title:"æ–¹å‘",dataIndex:"isVertical",width:80,render:t=>t?"ç«–å±":"æ¨ªå±"},{title:"åˆ›å»ºæ—¶é—´",dataIndex:"createdAt",width:150,render:t=>W(t)},{title:"æ›´æ–°æ—¶é—´",dataIndex:"updatedAt",width:150,render:t=>W(t)},{title:"æ“ä½œ",width:280,render:(t,s)=>e.jsxs(I,{children:[e.jsx(b,{onClick:()=>we(s),type:"link",children:"ç¼–è¾‘"}),e.jsx(b,{onClick:()=>Se(s),type:"link",children:"ä¸‹è½½"}),e.jsx(b,{onClick:()=>be(s),danger:!0,type:"link",children:"åˆ é™¤"})]})}],[U,we,be,Se]),Ze=async()=>{if(V(null),S.resetFields(),z)try{const t=await k.list(1,1,{seriesId:z}),s=t.items&&t.items.length>0?Math.max(...t.items.map(l=>l.episodeNumber||0)):0;S.setFieldsValue({seriesId:z,episodeNumber:s+1})}catch{S.setFieldsValue({seriesId:z})}E(!0)},Je=async()=>{const t=await S.validateFields();if(o)te(t),ee(!0);else try{await k.create(t),h.success("å·²åˆ›å»º"),E(!1),T()}catch{h.error("åˆ›å»ºå¤±è´¥")}};return e.jsxs("div",{className:"page",children:[e.jsxs(I,{className:"page-toolbar",wrap:!0,children:[e.jsx(b,{type:"primary",onClick:Ze,children:"æ–°å»ºå‰§é›†"}),e.jsx(b,{onClick:()=>T(),children:"åˆ·æ–°"}),e.jsx(B,{showSearch:!0,allowClear:!0,placeholder:"ç­›é€‰ç³»åˆ—",style:{width:280},filterOption:!1,options:U,value:z,loading:M,onDropdownVisibleChange:t=>{t&&U.length===0&&!M&&R({reset:!0})},onPopupScroll:t=>{const s=t.target,l=s&&s.scrollHeight-s.offsetHeight>0,r=s&&s.scrollTop+s.offsetHeight>=s.scrollHeight-20,n=s&&s.scrollTop>0;l&&r&&n&&xe&&!M&&R({page:he+1})},onSearch:t=>{O.current&&window.clearTimeout(O.current),O.current=window.setTimeout(()=>{M||R({reset:!0,keyword:(t||"").trim()})},300)},onChange:t=>Ae(t)}),e.jsx(_,{placeholder:"æœ€å°æ—¶é•¿(ç§’)",style:{width:140},value:H,onChange:t=>ge(t||void 0),min:0}),e.jsx("span",{style:{color:"#999"},children:"~"}),e.jsx(_,{placeholder:"æœ€å¤§æ—¶é•¿(ç§’)",style:{width:140},value:N,onChange:t=>je(t||void 0),min:0}),e.jsx(b,{onClick:()=>{ge(void 0),je(void 0)},children:"æ¸…é™¤æ—¶é•¿ç­›é€‰"})]}),e.jsx(nt,{rowKey:"id",loading:j,dataSource:Ee,columns:Xe,tableLayout:"fixed",scroll:{x:960},pagination:{current:Y,pageSize:G,total:Oe,position:["bottomCenter"],onChange:(t,s)=>T(t,s)}}),e.jsx(Q,{title:o?"ç¼–è¾‘å‰§é›†":"æ–°å»ºå‰§é›†",open:Le,onCancel:()=>E(!1),onOk:Je,okText:"ä¿å­˜",cancelText:"å–æ¶ˆ",width:800,style:{top:20},children:e.jsxs("div",{style:{maxHeight:"70vh",overflowY:"auto",paddingRight:8},children:[o&&e.jsxs("div",{style:{background:"#f5f5f5",padding:"16px",borderRadius:"8px",marginBottom:"20px"},children:[e.jsx(c.Title,{level:5,style:{marginTop:0,marginBottom:12},children:"ğŸ“Š åªè¯»ä¿¡æ¯"}),e.jsxs(I,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(c.Text,{type:"secondary",children:"ID:"}),e.jsx(c.Text,{strong:!0,children:o.id})]}),o.shortId&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(c.Text,{type:"secondary",children:"Short ID:"}),e.jsxs(I,{children:[e.jsx(c.Text,{code:!0,children:o.shortId}),e.jsx(b,{size:"small",icon:e.jsx(Ue,{}),onClick:()=>{navigator.clipboard.writeText(o.shortId||""),h.success("Short ID å·²å¤åˆ¶")}})]})]}),o.accessKey&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(c.Text,{type:"secondary",children:"Access Key:"}),e.jsxs(I,{children:[e.jsxs(c.Text,{code:!0,children:[o.accessKey.substring(0,8),"..."]}),e.jsx(b,{size:"small",icon:e.jsx(Ue,{}),onClick:()=>{navigator.clipboard.writeText(o.accessKey||""),h.success("Access Key å·²å¤åˆ¶")}})]})]}),o.playCount!==void 0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(c.Text,{type:"secondary",children:"æ’­æ”¾æ¬¡æ•°:"}),e.jsx(c.Text,{strong:!0,children:o.playCount.toLocaleString()})]}),o.likeCount!==void 0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(c.Text,{type:"secondary",children:"ç‚¹èµæ•°:"}),e.jsx(c.Text,{strong:!0,children:o.likeCount.toLocaleString()})]}),o.dislikeCount!==void 0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(c.Text,{type:"secondary",children:"ç‚¹è¸©æ•°:"}),e.jsx(c.Text,{strong:!0,children:o.dislikeCount.toLocaleString()})]}),o.favoriteCount!==void 0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(c.Text,{type:"secondary",children:"æ”¶è—æ•°:"}),e.jsx(c.Text,{strong:!0,children:o.favoriteCount.toLocaleString()})]}),o.createdAt&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(c.Text,{type:"secondary",children:"åˆ›å»ºæ—¶é—´:"}),e.jsx(c.Text,{children:W(o.createdAt)})]}),o.updatedAt&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(c.Text,{type:"secondary",children:"æ›´æ–°æ—¶é—´:"}),e.jsx(c.Text,{children:W(o.updatedAt)})]})]})]}),e.jsxs(C,{form:S,layout:"vertical",children:[e.jsx(ze,{orientation:"left",children:"ğŸ“„ åŸºæœ¬ä¿¡æ¯"}),e.jsx(C.Item,{name:"seriesId",label:"ç³»åˆ—",rules:[{required:!0,message:"è¯·é€‰æ‹©ç³»åˆ—"}],children:e.jsx(B,{showSearch:!0,allowClear:!0,placeholder:"æœç´¢ç³»åˆ—",filterOption:!1,options:U,loading:M,onDropdownVisibleChange:t=>{t&&U.length===0&&R({reset:!0})},onPopupScroll:t=>{const s=t.target,l=s&&s.scrollHeight-s.offsetHeight>0,r=s&&s.scrollTop+s.offsetHeight>=s.scrollHeight-20,n=s&&s.scrollTop>0;l&&r&&n&&xe&&!M&&R({page:he+1})},onSearch:t=>{O.current&&window.clearTimeout(O.current),O.current=window.setTimeout(()=>{R({reset:!0,keyword:(t||"").trim()})},300)}})}),e.jsxs(I,{style:{width:"100%"},size:"middle",children:[e.jsx(C.Item,{name:"episodeNumber",label:"é›†æ•°",rules:[{required:!0,message:"è¯·è¾“å…¥é›†æ•°"}],style:{marginBottom:0,flex:1},children:e.jsx(_,{style:{width:"100%"},placeholder:"é›†æ•°ç¼–å·",min:1})}),e.jsx(C.Item,{name:"duration",label:"æ—¶é•¿(ç§’)",rules:[{required:!0,message:"è¯·è¾“å…¥æ—¶é•¿"}],style:{marginBottom:0,flex:1},children:e.jsx(_,{style:{width:"100%"},placeholder:"è§†é¢‘æ—¶é•¿ï¼ˆç§’ï¼‰",min:0})})]}),e.jsx(C.Item,{name:"title",label:"æ ‡é¢˜",rules:[{required:!0,message:"è¯·è¾“å…¥æ ‡é¢˜"}],children:e.jsx(ot,{placeholder:"å‰§é›†æ ‡é¢˜"})}),e.jsx(ze,{orientation:"left",children:"ğŸ¬ æ’­æ”¾è®¾ç½®"}),e.jsxs(I,{style:{width:"100%"},size:"middle",children:[e.jsx(C.Item,{name:"status",label:"çŠ¶æ€",style:{marginBottom:0,flex:1},children:e.jsx(B,{placeholder:"é€‰æ‹©çŠ¶æ€",allowClear:!0,options:[{value:"published",label:"å·²å‘å¸ƒ"},{value:"hidden",label:"éšè—"},{value:"draft",label:"è‰ç¨¿"}]})}),e.jsx(C.Item,{name:"isVertical",label:"æ’­æ”¾æ–¹å‘",initialValue:!1,style:{marginBottom:0,flex:1},children:e.jsx(B,{placeholder:"é€‰æ‹©æ’­æ”¾æ–¹å‘",options:[{value:!1,label:"æ¨ªå±"},{value:!0,label:"ç«–å±"}]})})]}),e.jsx(C.Item,{name:"hasSequel",label:"æ˜¯å¦æœ‰ç»­é›†",children:e.jsx(B,{placeholder:"è¯·é€‰æ‹©",allowClear:!0,options:[{value:!0,label:"æ˜¯"},{value:!1,label:"å¦"}]})}),o&&e.jsx(C.Item,{label:"è§†é¢‘ä¸Šä¼ ",children:e.jsxs(I,{direction:"vertical",style:{width:"100%"},children:[o.urls&&o.urls.length>0&&e.jsxs("div",{style:{padding:"12px",background:"#f0f9ff",border:"1px solid #bae7ff",borderRadius:6,marginBottom:8},children:[e.jsx("div",{style:{fontSize:14,fontWeight:500,marginBottom:8,color:"#0958d9"},children:"ğŸ“¹ å·²æœ‰è§†é¢‘"}),o.urls.map((t,s)=>{const l=t.cdnUrl||t.ossUrl||t.originUrl||t.url||"";return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 0",borderTop:s>0?"1px solid #e6f4ff":"none"},children:[e.jsx("span",{style:{fontSize:12,fontWeight:500,color:"#0958d9",minWidth:50},children:t.quality}),e.jsx(P,{copyable:{text:l,tooltips:["å¤åˆ¶é“¾æ¥","å·²å¤åˆ¶"]},style:{margin:0,flex:1,fontSize:12,color:"#666"},ellipsis:{rows:1},children:l}),t.fileSize&&e.jsxs("span",{style:{fontSize:12,color:"#999",minWidth:60},children:[(t.fileSize/1024/1024).toFixed(1)," MB"]})]},s)})]}),e.jsxs(I,{children:[e.jsx(B,{value:$,onChange:Ne,style:{width:120},options:[{value:"360p",label:"360p"},{value:"480p",label:"480p"},{value:"720p",label:"720p"},{value:"1080p",label:"1080p"},{value:"1440p",label:"1440p"},{value:"2160p",label:"4K"}]}),e.jsx(lt,{accept:"video/mp4,video/mpeg,video/quicktime,video/x-msvideo,video/webm",showUploadList:!1,customRequest:Ge,disabled:oe,children:e.jsx(b,{type:"primary",icon:e.jsx(pt,{}),loading:oe,children:"ä¸Šä¼ è§†é¢‘æ–‡ä»¶"})})]}),oe&&le>0&&e.jsx("div",{style:{width:"100%"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{flex:1,height:8,background:"#f0f0f0",borderRadius:4,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",background:"#52c41a",width:`${le}%`,transition:"width 0.3s ease"}})}),e.jsxs("span",{style:{fontSize:12,color:"#666",minWidth:40},children:[le,"%"]})]})}),e.jsx("div",{style:{fontSize:12,color:"#999",padding:"8px 12px",background:"#f5f5f5",borderRadius:4},children:"ğŸ’¡ æç¤ºï¼šæ”¯æŒä¸Šä¼  MP4ã€MOVã€AVIã€WebM ç­‰è§†é¢‘æ ¼å¼ï¼Œè§†é¢‘å°†ç›´æ¥ä¸Šä¼ åˆ° R2 å­˜å‚¨ï¼ˆä¸ç»è¿‡åç«¯æœåŠ¡å™¨ï¼‰"})]})}),!o&&e.jsx(C.Item,{label:"è§†é¢‘ä¸Šä¼ ",children:e.jsx("div",{style:{padding:"12px 16px",background:"#f6f8fa",borderRadius:6,border:"1px solid #e1e4e8"},children:e.jsx("div",{style:{fontSize:14,color:"#586069"},children:"ğŸ’¡ æç¤ºï¼šè¯·å…ˆåˆ›å»ºå‰§é›†ï¼Œåˆ›å»ºå®Œæˆåå¯åœ¨ç¼–è¾‘é¡µé¢ä¸Šä¼ è§†é¢‘æ–‡ä»¶"})})})]})]})}),e.jsx(Q,{title:"ç¡®è®¤åˆ é™¤",open:Pe,onOk:We,onCancel:_e,okText:"ç¡®è®¤åˆ é™¤",cancelText:"å–æ¶ˆ",okType:"danger",children:e.jsxs("p",{children:["ç¡®å®šè¦åˆ é™¤å‰§é›†ã€Œ",A?.title,"ã€å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚"]})}),e.jsx(Q,{title:"ç¡®è®¤ä¿®æ”¹",open:Ve,onOk:Qe,onCancel:Ye,okText:"ç¡®è®¤ä¿®æ”¹",cancelText:"å–æ¶ˆ",children:e.jsxs("p",{children:["ç¡®å®šè¦ä¿®æ”¹å‰§é›†ã€Œ",F?.title,"ã€å—ï¼Ÿ"]})}),e.jsx(Q,{title:"å‰§é›†ä¸‹è½½åœ°å€",open:Fe,onCancel:()=>q(!1),footer:[e.jsx(b,{onClick:()=>q(!1),children:"å…³é—­"},"close")],width:900,children:He?e.jsx("div",{style:{textAlign:"center",padding:"60px 0",fontSize:16,color:"#999"},children:"åŠ è½½ä¸­..."}):m?e.jsxs("div",{children:[e.jsx("div",{style:{background:"#f5f5f5",padding:"16px 20px",borderRadius:8,marginBottom:20},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 24px"},children:[e.jsxs("div",{children:[e.jsx(w,{type:"secondary",style:{fontSize:13},children:"ç³»åˆ—"}),e.jsxs("div",{style:{marginTop:4,fontSize:15},children:[m.seriesTitle," ",e.jsxs(w,{type:"secondary",children:["(#",m.seriesId,")"]})]})]}),e.jsxs("div",{children:[e.jsx(w,{type:"secondary",style:{fontSize:13},children:"é›†æ•°"}),e.jsxs("div",{style:{marginTop:4,fontSize:15},children:["ç¬¬ ",m.episodeNumber," é›†"]})]}),e.jsxs("div",{children:[e.jsx(w,{type:"secondary",style:{fontSize:13},children:"æ ‡é¢˜"}),e.jsx("div",{style:{marginTop:4,fontSize:15},children:m.episodeTitle})]}),e.jsxs("div",{children:[e.jsx(w,{type:"secondary",style:{fontSize:13},children:"æ—¶é•¿"}),e.jsxs("div",{style:{marginTop:4,fontSize:15},children:[Math.floor(m.duration/60)," åˆ† ",m.duration%60," ç§’"]})]})]})}),m.downloadUrls&&m.downloadUrls.length>0?e.jsx("div",{style:{maxHeight:500,overflowY:"auto",paddingRight:8},children:m.downloadUrls.map((t,s)=>e.jsxs("div",{style:{marginBottom:s<m.downloadUrls.length-1?24:0,paddingBottom:s<m.downloadUrls.length-1?24:0,borderBottom:s<m.downloadUrls.length-1?"1px solid #f0f0f0":"none"},children:[e.jsx("div",{style:{background:"#fafafa",padding:"8px 16px",borderRadius:6,marginBottom:12,display:"inline-block"},children:e.jsx(w,{strong:!0,style:{fontSize:16,color:"#1890ff"},children:t.quality})}),e.jsxs("div",{style:{paddingLeft:12},children:[t.cdnUrl&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("div",{style:{marginBottom:6},children:e.jsx(w,{strong:!0,style:{fontSize:14},children:"è§†é¢‘é“¾æ¥"})}),e.jsx(P,{copyable:{text:t.cdnUrl,onCopy:()=>h.success("å·²å¤åˆ¶è§†é¢‘é“¾æ¥")},ellipsis:{rows:2,expandable:!0},style:{marginBottom:8,padding:"8px 12px",background:"#fff",border:"1px solid #e8e8e8",borderRadius:4,fontSize:13,fontFamily:"Monaco, Menlo, monospace"},children:t.cdnUrl}),e.jsx(b,{type:"primary",icon:e.jsx(rt,{}),onClick:()=>Ce(t.cdnUrl,`${m.episodeTitle}_${t.quality}.mp4`),children:"ä¸‹è½½è§†é¢‘"})]}),t.subtitleUrl&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("div",{style:{marginBottom:6},children:e.jsx(w,{strong:!0,style:{fontSize:14},children:"å­—å¹•æ–‡ä»¶"})}),e.jsx(P,{copyable:{text:t.subtitleUrl,onCopy:()=>h.success("å·²å¤åˆ¶å­—å¹•åœ°å€")},ellipsis:{rows:2,expandable:!0},style:{marginBottom:8,padding:"8px 12px",background:"#fff",border:"1px solid #e8e8e8",borderRadius:4,fontSize:13,fontFamily:"Monaco, Menlo, monospace"},children:t.subtitleUrl}),e.jsx(b,{icon:e.jsx(dt,{}),onClick:()=>Ce(t.subtitleUrl,`${m.episodeTitle}_${t.quality}.srt`),children:"ä¸‹è½½å­—å¹•"})]}),(t.ossUrl||t.originUrl)&&e.jsxs("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px dashed #e8e8e8"},children:[e.jsx(w,{type:"secondary",style:{fontSize:12,marginBottom:8,display:"block"},children:"åŸå§‹åœ°å€"}),t.ossUrl&&e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(w,{type:"secondary",style:{fontSize:13},children:"OSS: "}),e.jsx(P,{copyable:{text:t.ossUrl,onCopy:()=>h.success("å·²å¤åˆ¶ OSS åœ°å€")},ellipsis:{rows:1,expandable:!0},style:{display:"inline",marginBottom:0,fontSize:12,fontFamily:"Monaco, Menlo, monospace"},children:t.ossUrl})]}),t.originUrl&&e.jsxs("div",{children:[e.jsx(w,{type:"secondary",style:{fontSize:13},children:"åŸå§‹: "}),e.jsx(P,{copyable:{text:t.originUrl,onCopy:()=>h.success("å·²å¤åˆ¶åŸå§‹åœ°å€")},ellipsis:{rows:1,expandable:!0},style:{display:"inline",marginBottom:0,fontSize:12,fontFamily:"Monaco, Menlo, monospace"},children:t.originUrl})]})]})]})]},t.id))}):e.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:e.jsx(w,{type:"secondary",children:"æš‚æ— å¯ç”¨çš„ä¸‹è½½åœ°å€"})})]}):e.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:e.jsx(w,{type:"secondary",children:"æ— æ³•åŠ è½½ä¸‹è½½ä¿¡æ¯"})})})]})}export{St as default};
